
// Code automatically generated by T4 template from D:\vfs\OpenRTI-codegen\tests\rti1516ev\codegen\\RTFederate.xml, do not edit

#include <vector>
#include <cassert>

#include "RTI/encoding/HLAopaqueData.h"
#include "RTI/encoding/HLAhandle.h"

#include "RTFederateObjects.h"

namespace NDistSimIB {
namespace NRTFederateEncoding {
HLAobjectRootObjectClass::HLAobjectRootObjectClass(rti1516ev::RTIambassador* rtiAmbassador)
{
  mRtiAmbassador = rtiAmbassador;
  mObjectClassHandle = rtiAmbassador->getObjectClassHandle(L"HLAobjectRoot");
// attribute HLAobjectRoot.HLAprivilegeToDeleteObject : no data type
}

void HLAobjectRootObjectClass::Publish()
{
  if (!mPublished)
  {
    rti1516ev::AttributeHandleSet attributes = GetAllAttributeHandles();
    mRtiAmbassador->publishObjectClassAttributes(mObjectClassHandle, attributes);
    mPublished = true;
  }
}

void HLAobjectRootObjectClass::Unpublish()
{
  if (mPublished)
  {
    mRtiAmbassador->unpublishObjectClass(mObjectClassHandle);
    mPublished = false;
  }
}

void HLAobjectRootObjectClass::Subscribe()
{
  if (!mSubscribed)
  {
    rti1516ev::AttributeHandleSet attributes = GetAllAttributeHandles();
    mRtiAmbassador->subscribeObjectClassAttributes(mObjectClassHandle, attributes);
    mRtiAmbassador->setObjectClassDeliverToSelf(mObjectClassHandle, true);
    mSubscribed = true;
  }
}

void HLAobjectRootObjectClass::Unsubscribe()
{
  if (mSubscribed)
  {
    mRtiAmbassador->unsubscribeObjectClass(mObjectClassHandle);
    mSubscribed = false;
  }
}

void HLAobjectRootObjectClass::DiscoverObjectInstance(rti1516ev::ObjectInstanceHandle instanceHandle, const std::wstring& instanceName)
{
  assert(mObjectInstancesByName.find(instanceName) == mObjectInstancesByName.end());
  assert(mObjectInstancesByHandle.find(instanceHandle) == mObjectInstancesByHandle.end());
  HLAobjectRoot* newObject = new HLAobjectRoot(this, instanceName, mRtiAmbassador);
  newObject->mObjectInstanceHandle = instanceHandle;
  newObject->mIsOwner = false;
  mObjectInstancesByName.insert(std::make_pair(instanceName, newObject));
  mObjectInstancesByHandle.insert(std::make_pair(instanceHandle, newObject));
}

void HLAobjectRootObjectClass::RemoveObjectInstance(rti1516ev::ObjectInstanceHandle theObject)
{
  std::wstring instanceName = mRtiAmbassador->getObjectInstanceName(theObject);
  auto iter = mObjectInstancesByName.find(instanceName);
  assert(iter != mObjectInstancesByName.end());
  auto* objectInstance = iter->second;
  objectInstance->mObjectInstanceHandle = rti1516ev::ObjectInstanceHandle();
  mObjectInstancesByName.erase(iter);
  mObjectInstancesByHandle.erase(theObject);
}

IHLAobjectRoot* HLAobjectRootObjectClass::GetObjectInstance(const std::wstring& instanceName)
{
  auto iter = mObjectInstancesByName.find(instanceName);
  if (iter != mObjectInstancesByName.end())
  {
    return iter->second;
  }
  else
  {
    return nullptr;
  }
}

IHLAobjectRoot* HLAobjectRootObjectClass::GetObjectInstance(rti1516ev::ObjectInstanceHandle instanceHandle)
{
  auto iter = mObjectInstancesByHandle.find(instanceHandle);
  if (iter != mObjectInstancesByHandle.end())
  {
    return iter->second;
  }
  else
  {
    return nullptr;
  }
}

IHLAobjectRoot* HLAobjectRootObjectClass::CreateObjectInstance(const std::wstring& instanceName)
{
  auto iter = mObjectInstancesByName.find(instanceName);
  if (iter != mObjectInstancesByName.end())
  {
    return nullptr;
  }
  if (!mPublished)
  {
    throw rti1516ev::ObjectClassNotPublished(L"HLAobjectRoot");
  }
  HLAobjectRoot* newObject = new HLAobjectRoot(this, instanceName, mRtiAmbassador);
  ObjectClassRegistry::GetInstance()->RegisterObjectInstanceName(instanceName, [this, newObject, instanceName](bool success) {
    if (success) {
      rti1516ev::ObjectInstanceHandle instanceHandle = mRtiAmbassador->registerObjectInstance(mObjectClassHandle, instanceName);
      newObject->mObjectInstanceHandle = instanceHandle;
      newObject->mIsOwner = true;
      mObjectInstancesByHandle.insert(std::make_pair(instanceHandle, newObject));
    }
  });
  mObjectInstancesByName.insert(std::make_pair(instanceName, newObject));
  return newObject;
}

rti1516ev::AttributeHandleSet HLAobjectRootObjectClass::GetAllAttributeHandles()
{
  rti1516ev::AttributeHandleSet result;
  return result;
}

// object instances of type 'HLAobjectRoot'
HLAobjectRoot::HLAobjectRoot()
{
}

HLAobjectRoot::HLAobjectRoot(HLAobjectRootObjectClass* objectClass, const std::wstring& instanceName, rti1516ev::RTIambassador* rtiAmbassador)
  : mObjectClass(objectClass)
  , mInstanceName(instanceName)
  , mRtiAmbassador(rtiAmbassador)
{
}

HLAobjectRoot::~HLAobjectRoot()
{
  if (mObjectInstanceHandle.isValid() && mIsOwner)
  {
    mRtiAmbassador->deleteObjectInstance(mObjectInstanceHandle, rti1516ev::VariableLengthData());
    mObjectInstanceHandle = rti1516ev::ObjectInstanceHandle();
    mIsOwner = false;
  }
}

// attribute HLAobjectRoot.HLAprivilegeToDeleteObject : no data type

rti1516ev::AttributeHandleValueMap HLAobjectRoot::GetAllAttributeValues() const
{
  rti1516ev::AttributeHandleValueMap result;
  return result;
}

rti1516ev::AttributeHandleValueMap HLAobjectRoot::GetModifiedAttributeValues() const
{
  rti1516ev::AttributeHandleValueMap result;
  return result;
}


// object class type 'SystemVariable'
SystemVariableObjectClass::SystemVariableObjectClass(rti1516ev::RTIambassador* rtiAmbassador, HLAobjectRootObjectClass* baseClass)
{
  mRtiAmbassador = rtiAmbassador;
  mBaseClass = baseClass;
  mObjectClassHandle = rtiAmbassador->getObjectClassHandle(L"HLAobjectRoot.SystemVariable");
  // attribute Value : HLAopaqueData
  mValueAttributeHandle = rtiAmbassador->getAttributeHandle(mObjectClassHandle, L"Value");
}

void SystemVariableObjectClass::Publish()
{
  if (!mPublished)
  {
    rti1516ev::AttributeHandleSet attributes = GetAllAttributeHandles();
    mRtiAmbassador->publishObjectClassAttributes(mObjectClassHandle, attributes);
    mPublished = true;
  }
}

void SystemVariableObjectClass::Unpublish()
{
  if (mPublished)
  {
    mRtiAmbassador->unpublishObjectClass(mObjectClassHandle);
    mPublished = false;
  }
}

void SystemVariableObjectClass::Subscribe()
{
  if (!mSubscribed)
  {
    rti1516ev::AttributeHandleSet attributes = GetAllAttributeHandles();
    mRtiAmbassador->subscribeObjectClassAttributes(mObjectClassHandle, attributes);
    mRtiAmbassador->setObjectClassDeliverToSelf(mObjectClassHandle, true);
    mSubscribed = true;
  }
}

void SystemVariableObjectClass::Unsubscribe()
{
  if (mSubscribed)
  {
    mRtiAmbassador->unsubscribeObjectClass(mObjectClassHandle);
    mSubscribed = false;
  }
}

void SystemVariableObjectClass::DiscoverObjectInstance(rti1516ev::ObjectInstanceHandle instanceHandle, const std::wstring& instanceName)
{
  assert(mObjectInstancesByName.find(instanceName) == mObjectInstancesByName.end());
  assert(mObjectInstancesByHandle.find(instanceHandle) == mObjectInstancesByHandle.end());
  SystemVariable* newObject = new SystemVariable(this, instanceName, mRtiAmbassador);
  newObject->mObjectInstanceHandle = instanceHandle;
  newObject->mIsOwner = false;
  mObjectInstancesByName.insert(std::make_pair(instanceName, newObject));
  mObjectInstancesByHandle.insert(std::make_pair(instanceHandle, newObject));
}

void SystemVariableObjectClass::RemoveObjectInstance(rti1516ev::ObjectInstanceHandle theObject)
{
  std::wstring instanceName = mRtiAmbassador->getObjectInstanceName(theObject);
  auto iter = mObjectInstancesByName.find(instanceName);
  assert(iter != mObjectInstancesByName.end());
  auto* objectInstance = iter->second;
  objectInstance->mObjectInstanceHandle = rti1516ev::ObjectInstanceHandle();
  mObjectInstancesByName.erase(iter);
  mObjectInstancesByHandle.erase(theObject);
}

ISystemVariable* SystemVariableObjectClass::GetObjectInstance(const std::wstring& instanceName)
{
  auto iter = mObjectInstancesByName.find(instanceName);
  if (iter != mObjectInstancesByName.end())
  {
    return iter->second;
  }
  else
  {
    return nullptr;
  }
}

ISystemVariable* SystemVariableObjectClass::GetObjectInstance(rti1516ev::ObjectInstanceHandle instanceHandle)
{
  auto iter = mObjectInstancesByHandle.find(instanceHandle);
  if (iter != mObjectInstancesByHandle.end())
  {
    return iter->second;
  }
  else
  {
    return nullptr;
  }
}

ISystemVariable* SystemVariableObjectClass::CreateObjectInstance(const std::wstring& instanceName)
{
  auto iter = mObjectInstancesByName.find(instanceName);
  if (iter != mObjectInstancesByName.end())
  {
    return nullptr;
  }
  if (!mPublished)
  {
    throw rti1516ev::ObjectClassNotPublished(L"SystemVariable");
  }
  SystemVariable* newObject = new SystemVariable(this, instanceName, mRtiAmbassador);
  ObjectClassRegistry::GetInstance()->RegisterObjectInstanceName(instanceName, [this, newObject, instanceName](bool success) {
    if (success) {
      rti1516ev::ObjectInstanceHandle instanceHandle = mRtiAmbassador->registerObjectInstance(mObjectClassHandle, instanceName);
      newObject->mObjectInstanceHandle = instanceHandle;
      newObject->mIsOwner = true;
      mObjectInstancesByHandle.insert(std::make_pair(instanceHandle, newObject));
    }
  });
  mObjectInstancesByName.insert(std::make_pair(instanceName, newObject));
  return newObject;
}

rti1516ev::AttributeHandleSet SystemVariableObjectClass::GetAllAttributeHandles()
{
  rti1516ev::AttributeHandleSet result;
  result.insert(GetValueAttributeHandle());
  return result;
}

// object instances of type 'SystemVariable'
SystemVariable::SystemVariable()
{
}

SystemVariable::SystemVariable(SystemVariableObjectClass* objectClass, const std::wstring& instanceName, rti1516ev::RTIambassador* rtiAmbassador)
  : mObjectClass(objectClass)
  , mInstanceName(instanceName)
  , mRtiAmbassador(rtiAmbassador)
{
}

SystemVariable::~SystemVariable()
{
  if (mObjectInstanceHandle.isValid() && mIsOwner)
  {
    mRtiAmbassador->deleteObjectInstance(mObjectInstanceHandle, rti1516ev::VariableLengthData());
    mObjectInstanceHandle = rti1516ev::ObjectInstanceHandle();
    mIsOwner = false;
  }
}

// attribute SystemVariable.HLAprivilegeToDeleteObject : no data type

// attribute Value : HLAopaqueData
std::vector<uint8_t> SystemVariable::GetValue() const
{
  return mValue.get();
}

void SystemVariable::SetValue(std::vector<uint8_t> newValue)
{
  mValue.set(newValue);
  mDirty |= kValueBit;
}

rti1516ev::AttributeHandleValueMap SystemVariable::GetAllAttributeValues() const
{
  rti1516ev::AttributeHandleValueMap result;
  result[mObjectClass->GetValueAttributeHandle()] = mValue.encode();
  return result;
}

rti1516ev::AttributeHandleValueMap SystemVariable::GetModifiedAttributeValues() const
{
  rti1516ev::AttributeHandleValueMap result;
  if (mDirty & kValueBit)
  {
    result[mObjectClass->GetValueAttributeHandle()] = mValue.encode();
  }
  return result;
}

void SystemVariable::UpdateAllAttributeValues()
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetAllAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData());
  }
}

void SystemVariable::UpdateAllAttributeValues(const rti1516ev::LogicalTime& time)
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetAllAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData(), time);
  }
}

void SystemVariable::UpdateModifiedAttributeValues()
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetModifiedAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData());
    mDirty = kNone;
  }
}

void SystemVariable::UpdateModifiedAttributeValues(const rti1516ev::LogicalTime& time)
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetModifiedAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData(), time);
    mDirty = kNone;
  }
}

void SystemVariable::ReflectAttributeValues(const rti1516ev::AttributeHandleValueMap& attributes)
{
  for (auto& attributeHandleValue : attributes)
  {
    rti1516ev::AttributeHandle attributeHandle = attributeHandleValue.first;
    if (attributeHandle == mObjectClass->GetValueAttributeHandle())
    {
      mValue.decode(attributeHandleValue.second);
      mLastUpdated |= kValueBit;
    }
  } // for (auto& attributeHandleValue : attributes)
    ExecuteUpdateCallbacks();
} // SystemVariable::ReflectAttributeValues

void SystemVariable::ProvideAttributeValues(const rti1516ev::AttributeHandleSet& attributeHandles)
{
  rti1516ev::AttributeHandleValueMap updateAttributes;
  for (auto& attributeHandle : attributeHandles)
  {
    if (attributeHandle == mObjectClass->GetValueAttributeHandle())
    {
      updateAttributes.insert(std::make_pair(attributeHandle, mValue.encode()));
      mDirty &= ~kValueBit;
    }
  } // for (auto& attributeHandleValue : attributes)
  mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, updateAttributes, rti1516ev::VariableLengthData());
} // SystemVariable::ReflectAttributeValues

uint32_t SystemVariable::RegisterUpdateCallback(UpdateCallbackType callback)
{
  mLastCallbackToken++;
  mUpdateCallbacks.insert(std::make_pair(mLastCallbackToken, callback));
  return mLastCallbackToken;
}

void SystemVariable::UnregisterUpdateCallback(uint32_t callbackToken)
{
  mUpdateCallbacks.erase(callbackToken);
}

void SystemVariable::ExecuteUpdateCallbacks()
{
  for (auto& callbackEntry : mUpdateCallbacks)
  {
    auto& callback = callbackEntry.second;
    callback(this);
  }
}

// object class type 'ValueEntity'
ValueEntityObjectClass::ValueEntityObjectClass(rti1516ev::RTIambassador* rtiAmbassador, HLAobjectRootObjectClass* baseClass)
{
  mRtiAmbassador = rtiAmbassador;
  mBaseClass = baseClass;
  mObjectClassHandle = rtiAmbassador->getObjectClassHandle(L"HLAobjectRoot.ValueEntity");
  // attribute Value : HLAopaqueData
  mValueAttributeHandle = rtiAmbassador->getAttributeHandle(mObjectClassHandle, L"Value");
}

void ValueEntityObjectClass::Publish()
{
  if (!mPublished)
  {
    rti1516ev::AttributeHandleSet attributes = GetAllAttributeHandles();
    mRtiAmbassador->publishObjectClassAttributes(mObjectClassHandle, attributes);
    mPublished = true;
  }
}

void ValueEntityObjectClass::Unpublish()
{
  if (mPublished)
  {
    mRtiAmbassador->unpublishObjectClass(mObjectClassHandle);
    mPublished = false;
  }
}

void ValueEntityObjectClass::Subscribe()
{
  if (!mSubscribed)
  {
    rti1516ev::AttributeHandleSet attributes = GetAllAttributeHandles();
    mRtiAmbassador->subscribeObjectClassAttributes(mObjectClassHandle, attributes);
    mRtiAmbassador->setObjectClassDeliverToSelf(mObjectClassHandle, true);
    mSubscribed = true;
  }
}

void ValueEntityObjectClass::Unsubscribe()
{
  if (mSubscribed)
  {
    mRtiAmbassador->unsubscribeObjectClass(mObjectClassHandle);
    mSubscribed = false;
  }
}

void ValueEntityObjectClass::DiscoverObjectInstance(rti1516ev::ObjectInstanceHandle instanceHandle, const std::wstring& instanceName)
{
  assert(mObjectInstancesByName.find(instanceName) == mObjectInstancesByName.end());
  assert(mObjectInstancesByHandle.find(instanceHandle) == mObjectInstancesByHandle.end());
  ValueEntity* newObject = new ValueEntity(this, instanceName, mRtiAmbassador);
  newObject->mObjectInstanceHandle = instanceHandle;
  newObject->mIsOwner = false;
  mObjectInstancesByName.insert(std::make_pair(instanceName, newObject));
  mObjectInstancesByHandle.insert(std::make_pair(instanceHandle, newObject));
}

void ValueEntityObjectClass::RemoveObjectInstance(rti1516ev::ObjectInstanceHandle theObject)
{
  std::wstring instanceName = mRtiAmbassador->getObjectInstanceName(theObject);
  auto iter = mObjectInstancesByName.find(instanceName);
  assert(iter != mObjectInstancesByName.end());
  auto* objectInstance = iter->second;
  objectInstance->mObjectInstanceHandle = rti1516ev::ObjectInstanceHandle();
  mObjectInstancesByName.erase(iter);
  mObjectInstancesByHandle.erase(theObject);
}

IValueEntity* ValueEntityObjectClass::GetObjectInstance(const std::wstring& instanceName)
{
  auto iter = mObjectInstancesByName.find(instanceName);
  if (iter != mObjectInstancesByName.end())
  {
    return iter->second;
  }
  else
  {
    return nullptr;
  }
}

IValueEntity* ValueEntityObjectClass::GetObjectInstance(rti1516ev::ObjectInstanceHandle instanceHandle)
{
  auto iter = mObjectInstancesByHandle.find(instanceHandle);
  if (iter != mObjectInstancesByHandle.end())
  {
    return iter->second;
  }
  else
  {
    return nullptr;
  }
}

IValueEntity* ValueEntityObjectClass::CreateObjectInstance(const std::wstring& instanceName)
{
  auto iter = mObjectInstancesByName.find(instanceName);
  if (iter != mObjectInstancesByName.end())
  {
    return nullptr;
  }
  if (!mPublished)
  {
    throw rti1516ev::ObjectClassNotPublished(L"ValueEntity");
  }
  ValueEntity* newObject = new ValueEntity(this, instanceName, mRtiAmbassador);
  ObjectClassRegistry::GetInstance()->RegisterObjectInstanceName(instanceName, [this, newObject, instanceName](bool success) {
    if (success) {
      rti1516ev::ObjectInstanceHandle instanceHandle = mRtiAmbassador->registerObjectInstance(mObjectClassHandle, instanceName);
      newObject->mObjectInstanceHandle = instanceHandle;
      newObject->mIsOwner = true;
      mObjectInstancesByHandle.insert(std::make_pair(instanceHandle, newObject));
    }
  });
  mObjectInstancesByName.insert(std::make_pair(instanceName, newObject));
  return newObject;
}

rti1516ev::AttributeHandleSet ValueEntityObjectClass::GetAllAttributeHandles()
{
  rti1516ev::AttributeHandleSet result;
  result.insert(GetValueAttributeHandle());
  return result;
}

// object instances of type 'ValueEntity'
ValueEntity::ValueEntity()
{
}

ValueEntity::ValueEntity(ValueEntityObjectClass* objectClass, const std::wstring& instanceName, rti1516ev::RTIambassador* rtiAmbassador)
  : mObjectClass(objectClass)
  , mInstanceName(instanceName)
  , mRtiAmbassador(rtiAmbassador)
{
}

ValueEntity::~ValueEntity()
{
  if (mObjectInstanceHandle.isValid() && mIsOwner)
  {
    mRtiAmbassador->deleteObjectInstance(mObjectInstanceHandle, rti1516ev::VariableLengthData());
    mObjectInstanceHandle = rti1516ev::ObjectInstanceHandle();
    mIsOwner = false;
  }
}

// attribute ValueEntity.HLAprivilegeToDeleteObject : no data type

// attribute Value : HLAopaqueData
std::vector<uint8_t> ValueEntity::GetValue() const
{
  return mValue.get();
}

void ValueEntity::SetValue(std::vector<uint8_t> newValue)
{
  mValue.set(newValue);
  mDirty |= kValueBit;
}

rti1516ev::AttributeHandleValueMap ValueEntity::GetAllAttributeValues() const
{
  rti1516ev::AttributeHandleValueMap result;
  result[mObjectClass->GetValueAttributeHandle()] = mValue.encode();
  return result;
}

rti1516ev::AttributeHandleValueMap ValueEntity::GetModifiedAttributeValues() const
{
  rti1516ev::AttributeHandleValueMap result;
  if (mDirty & kValueBit)
  {
    result[mObjectClass->GetValueAttributeHandle()] = mValue.encode();
  }
  return result;
}

void ValueEntity::UpdateAllAttributeValues()
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetAllAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData());
  }
}

void ValueEntity::UpdateAllAttributeValues(const rti1516ev::LogicalTime& time)
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetAllAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData(), time);
  }
}

void ValueEntity::UpdateModifiedAttributeValues()
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetModifiedAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData());
    mDirty = kNone;
  }
}

void ValueEntity::UpdateModifiedAttributeValues(const rti1516ev::LogicalTime& time)
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetModifiedAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData(), time);
    mDirty = kNone;
  }
}

void ValueEntity::ReflectAttributeValues(const rti1516ev::AttributeHandleValueMap& attributes)
{
  for (auto& attributeHandleValue : attributes)
  {
    rti1516ev::AttributeHandle attributeHandle = attributeHandleValue.first;
    if (attributeHandle == mObjectClass->GetValueAttributeHandle())
    {
      mValue.decode(attributeHandleValue.second);
      mLastUpdated |= kValueBit;
    }
  } // for (auto& attributeHandleValue : attributes)
    ExecuteUpdateCallbacks();
} // ValueEntity::ReflectAttributeValues

void ValueEntity::ProvideAttributeValues(const rti1516ev::AttributeHandleSet& attributeHandles)
{
  rti1516ev::AttributeHandleValueMap updateAttributes;
  for (auto& attributeHandle : attributeHandles)
  {
    if (attributeHandle == mObjectClass->GetValueAttributeHandle())
    {
      updateAttributes.insert(std::make_pair(attributeHandle, mValue.encode()));
      mDirty &= ~kValueBit;
    }
  } // for (auto& attributeHandleValue : attributes)
  mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, updateAttributes, rti1516ev::VariableLengthData());
} // ValueEntity::ReflectAttributeValues

uint32_t ValueEntity::RegisterUpdateCallback(UpdateCallbackType callback)
{
  mLastCallbackToken++;
  mUpdateCallbacks.insert(std::make_pair(mLastCallbackToken, callback));
  return mLastCallbackToken;
}

void ValueEntity::UnregisterUpdateCallback(uint32_t callbackToken)
{
  mUpdateCallbacks.erase(callbackToken);
}

void ValueEntity::ExecuteUpdateCallbacks()
{
  for (auto& callbackEntry : mUpdateCallbacks)
  {
    auto& callback = callbackEntry.second;
    callback(this);
  }
}

// object class type 'DOMemberSource'
DOMemberSourceObjectClass::DOMemberSourceObjectClass(rti1516ev::RTIambassador* rtiAmbassador, HLAobjectRootObjectClass* baseClass)
{
  mRtiAmbassador = rtiAmbassador;
  mBaseClass = baseClass;
  mObjectClassHandle = rtiAmbassador->getObjectClassHandle(L"HLAobjectRoot.DOMemberSource");
  // attribute DOSourceMemberName : HLAASCIIstring
  mDOSourceMemberNameAttributeHandle = rtiAmbassador->getAttributeHandle(mObjectClassHandle, L"DOSourceMemberName");
  // attribute DOSourceMemberConnectionType : HLAASCIIstring
  mDOSourceMemberConnectionTypeAttributeHandle = rtiAmbassador->getAttributeHandle(mObjectClassHandle, L"DOSourceMemberConnectionType");
  // attribute DOSourceMemberDataBytes : HLAopaqueData
  mDOSourceMemberDataBytesAttributeHandle = rtiAmbassador->getAttributeHandle(mObjectClassHandle, L"DOSourceMemberDataBytes");
}

void DOMemberSourceObjectClass::Publish()
{
  if (!mPublished)
  {
    rti1516ev::AttributeHandleSet attributes = GetAllAttributeHandles();
    mRtiAmbassador->publishObjectClassAttributes(mObjectClassHandle, attributes);
    mPublished = true;
  }
}

void DOMemberSourceObjectClass::Unpublish()
{
  if (mPublished)
  {
    mRtiAmbassador->unpublishObjectClass(mObjectClassHandle);
    mPublished = false;
  }
}

void DOMemberSourceObjectClass::Subscribe()
{
  if (!mSubscribed)
  {
    rti1516ev::AttributeHandleSet attributes = GetAllAttributeHandles();
    mRtiAmbassador->subscribeObjectClassAttributes(mObjectClassHandle, attributes);
    mRtiAmbassador->setObjectClassDeliverToSelf(mObjectClassHandle, true);
    mSubscribed = true;
  }
}

void DOMemberSourceObjectClass::Unsubscribe()
{
  if (mSubscribed)
  {
    mRtiAmbassador->unsubscribeObjectClass(mObjectClassHandle);
    mSubscribed = false;
  }
}

void DOMemberSourceObjectClass::DiscoverObjectInstance(rti1516ev::ObjectInstanceHandle instanceHandle, const std::wstring& instanceName)
{
  assert(mObjectInstancesByName.find(instanceName) == mObjectInstancesByName.end());
  assert(mObjectInstancesByHandle.find(instanceHandle) == mObjectInstancesByHandle.end());
  DOMemberSource* newObject = new DOMemberSource(this, instanceName, mRtiAmbassador);
  newObject->mObjectInstanceHandle = instanceHandle;
  newObject->mIsOwner = false;
  mObjectInstancesByName.insert(std::make_pair(instanceName, newObject));
  mObjectInstancesByHandle.insert(std::make_pair(instanceHandle, newObject));
}

void DOMemberSourceObjectClass::RemoveObjectInstance(rti1516ev::ObjectInstanceHandle theObject)
{
  std::wstring instanceName = mRtiAmbassador->getObjectInstanceName(theObject);
  auto iter = mObjectInstancesByName.find(instanceName);
  assert(iter != mObjectInstancesByName.end());
  auto* objectInstance = iter->second;
  objectInstance->mObjectInstanceHandle = rti1516ev::ObjectInstanceHandle();
  mObjectInstancesByName.erase(iter);
  mObjectInstancesByHandle.erase(theObject);
}

IDOMemberSource* DOMemberSourceObjectClass::GetObjectInstance(const std::wstring& instanceName)
{
  auto iter = mObjectInstancesByName.find(instanceName);
  if (iter != mObjectInstancesByName.end())
  {
    return iter->second;
  }
  else
  {
    return nullptr;
  }
}

IDOMemberSource* DOMemberSourceObjectClass::GetObjectInstance(rti1516ev::ObjectInstanceHandle instanceHandle)
{
  auto iter = mObjectInstancesByHandle.find(instanceHandle);
  if (iter != mObjectInstancesByHandle.end())
  {
    return iter->second;
  }
  else
  {
    return nullptr;
  }
}

IDOMemberSource* DOMemberSourceObjectClass::CreateObjectInstance(const std::wstring& instanceName)
{
  auto iter = mObjectInstancesByName.find(instanceName);
  if (iter != mObjectInstancesByName.end())
  {
    return nullptr;
  }
  if (!mPublished)
  {
    throw rti1516ev::ObjectClassNotPublished(L"DOMemberSource");
  }
  DOMemberSource* newObject = new DOMemberSource(this, instanceName, mRtiAmbassador);
  ObjectClassRegistry::GetInstance()->RegisterObjectInstanceName(instanceName, [this, newObject, instanceName](bool success) {
    if (success) {
      rti1516ev::ObjectInstanceHandle instanceHandle = mRtiAmbassador->registerObjectInstance(mObjectClassHandle, instanceName);
      newObject->mObjectInstanceHandle = instanceHandle;
      newObject->mIsOwner = true;
      mObjectInstancesByHandle.insert(std::make_pair(instanceHandle, newObject));
    }
  });
  mObjectInstancesByName.insert(std::make_pair(instanceName, newObject));
  return newObject;
}

rti1516ev::AttributeHandleSet DOMemberSourceObjectClass::GetAllAttributeHandles()
{
  rti1516ev::AttributeHandleSet result;
  result.insert(GetDOSourceMemberNameAttributeHandle());
  result.insert(GetDOSourceMemberConnectionTypeAttributeHandle());
  result.insert(GetDOSourceMemberDataBytesAttributeHandle());
  return result;
}

// object instances of type 'DOMemberSource'
DOMemberSource::DOMemberSource()
{
}

DOMemberSource::DOMemberSource(DOMemberSourceObjectClass* objectClass, const std::wstring& instanceName, rti1516ev::RTIambassador* rtiAmbassador)
  : mObjectClass(objectClass)
  , mInstanceName(instanceName)
  , mRtiAmbassador(rtiAmbassador)
{
}

DOMemberSource::~DOMemberSource()
{
  if (mObjectInstanceHandle.isValid() && mIsOwner)
  {
    mRtiAmbassador->deleteObjectInstance(mObjectInstanceHandle, rti1516ev::VariableLengthData());
    mObjectInstanceHandle = rti1516ev::ObjectInstanceHandle();
    mIsOwner = false;
  }
}

// attribute DOMemberSource.HLAprivilegeToDeleteObject : no data type

// attribute DOSourceMemberName : HLAASCIIstring
std::string DOMemberSource::GetDOSourceMemberName() const
{
  return mDOSourceMemberName.get();
}

void DOMemberSource::SetDOSourceMemberName(std::string newValue)
{
  mDOSourceMemberName.set(newValue);
  mDirty |= kDOSourceMemberNameBit;
}

// attribute DOSourceMemberConnectionType : HLAASCIIstring
std::string DOMemberSource::GetDOSourceMemberConnectionType() const
{
  return mDOSourceMemberConnectionType.get();
}

void DOMemberSource::SetDOSourceMemberConnectionType(std::string newValue)
{
  mDOSourceMemberConnectionType.set(newValue);
  mDirty |= kDOSourceMemberConnectionTypeBit;
}

// attribute DOSourceMemberDataBytes : HLAopaqueData
std::vector<uint8_t> DOMemberSource::GetDOSourceMemberDataBytes() const
{
  return mDOSourceMemberDataBytes.get();
}

void DOMemberSource::SetDOSourceMemberDataBytes(std::vector<uint8_t> newValue)
{
  mDOSourceMemberDataBytes.set(newValue);
  mDirty |= kDOSourceMemberDataBytesBit;
}

rti1516ev::AttributeHandleValueMap DOMemberSource::GetAllAttributeValues() const
{
  rti1516ev::AttributeHandleValueMap result;
  result[mObjectClass->GetDOSourceMemberNameAttributeHandle()] = mDOSourceMemberName.encode();
  result[mObjectClass->GetDOSourceMemberConnectionTypeAttributeHandle()] = mDOSourceMemberConnectionType.encode();
  result[mObjectClass->GetDOSourceMemberDataBytesAttributeHandle()] = mDOSourceMemberDataBytes.encode();
  return result;
}

rti1516ev::AttributeHandleValueMap DOMemberSource::GetModifiedAttributeValues() const
{
  rti1516ev::AttributeHandleValueMap result;
  if (mDirty & kDOSourceMemberNameBit)
  {
    result[mObjectClass->GetDOSourceMemberNameAttributeHandle()] = mDOSourceMemberName.encode();
  }
  if (mDirty & kDOSourceMemberConnectionTypeBit)
  {
    result[mObjectClass->GetDOSourceMemberConnectionTypeAttributeHandle()] = mDOSourceMemberConnectionType.encode();
  }
  if (mDirty & kDOSourceMemberDataBytesBit)
  {
    result[mObjectClass->GetDOSourceMemberDataBytesAttributeHandle()] = mDOSourceMemberDataBytes.encode();
  }
  return result;
}

void DOMemberSource::UpdateAllAttributeValues()
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetAllAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData());
  }
}

void DOMemberSource::UpdateAllAttributeValues(const rti1516ev::LogicalTime& time)
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetAllAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData(), time);
  }
}

void DOMemberSource::UpdateModifiedAttributeValues()
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetModifiedAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData());
    mDirty = kNone;
  }
}

void DOMemberSource::UpdateModifiedAttributeValues(const rti1516ev::LogicalTime& time)
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetModifiedAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData(), time);
    mDirty = kNone;
  }
}

void DOMemberSource::ReflectAttributeValues(const rti1516ev::AttributeHandleValueMap& attributes)
{
  for (auto& attributeHandleValue : attributes)
  {
    rti1516ev::AttributeHandle attributeHandle = attributeHandleValue.first;
    if (attributeHandle == mObjectClass->GetDOSourceMemberNameAttributeHandle())
    {
      mDOSourceMemberName.decode(attributeHandleValue.second);
      mLastUpdated |= kDOSourceMemberNameBit;
    }
    else if (attributeHandle == mObjectClass->GetDOSourceMemberConnectionTypeAttributeHandle())
    {
      mDOSourceMemberConnectionType.decode(attributeHandleValue.second);
      mLastUpdated |= kDOSourceMemberConnectionTypeBit;
    }
    else if (attributeHandle == mObjectClass->GetDOSourceMemberDataBytesAttributeHandle())
    {
      mDOSourceMemberDataBytes.decode(attributeHandleValue.second);
      mLastUpdated |= kDOSourceMemberDataBytesBit;
    }
  } // for (auto& attributeHandleValue : attributes)
    ExecuteUpdateCallbacks();
} // DOMemberSource::ReflectAttributeValues

void DOMemberSource::ProvideAttributeValues(const rti1516ev::AttributeHandleSet& attributeHandles)
{
  rti1516ev::AttributeHandleValueMap updateAttributes;
  for (auto& attributeHandle : attributeHandles)
  {
    if (attributeHandle == mObjectClass->GetDOSourceMemberNameAttributeHandle())
    {
      updateAttributes.insert(std::make_pair(attributeHandle, mDOSourceMemberName.encode()));
      mDirty &= ~kDOSourceMemberNameBit;
    }
    else if (attributeHandle == mObjectClass->GetDOSourceMemberConnectionTypeAttributeHandle())
    {
      updateAttributes.insert(std::make_pair(attributeHandle, mDOSourceMemberConnectionType.encode()));
      mDirty &= ~kDOSourceMemberConnectionTypeBit;
    }
    else if (attributeHandle == mObjectClass->GetDOSourceMemberDataBytesAttributeHandle())
    {
      updateAttributes.insert(std::make_pair(attributeHandle, mDOSourceMemberDataBytes.encode()));
      mDirty &= ~kDOSourceMemberDataBytesBit;
    }
  } // for (auto& attributeHandleValue : attributes)
  mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, updateAttributes, rti1516ev::VariableLengthData());
} // DOMemberSource::ReflectAttributeValues

uint32_t DOMemberSource::RegisterUpdateCallback(UpdateCallbackType callback)
{
  mLastCallbackToken++;
  mUpdateCallbacks.insert(std::make_pair(mLastCallbackToken, callback));
  return mLastCallbackToken;
}

void DOMemberSource::UnregisterUpdateCallback(uint32_t callbackToken)
{
  mUpdateCallbacks.erase(callbackToken);
}

void DOMemberSource::ExecuteUpdateCallbacks()
{
  for (auto& callbackEntry : mUpdateCallbacks)
  {
    auto& callback = callbackEntry.second;
    callback(this);
  }
}

// object class type 'DOMemberTarget'
DOMemberTargetObjectClass::DOMemberTargetObjectClass(rti1516ev::RTIambassador* rtiAmbassador, HLAobjectRootObjectClass* baseClass)
{
  mRtiAmbassador = rtiAmbassador;
  mBaseClass = baseClass;
  mObjectClassHandle = rtiAmbassador->getObjectClassHandle(L"HLAobjectRoot.DOMemberTarget");
  // attribute DOTargetMemberName : HLAASCIIstring
  mDOTargetMemberNameAttributeHandle = rtiAmbassador->getAttributeHandle(mObjectClassHandle, L"DOTargetMemberName");
  // attribute DOTargetMemberConnectionType : HLAASCIIstring
  mDOTargetMemberConnectionTypeAttributeHandle = rtiAmbassador->getAttributeHandle(mObjectClassHandle, L"DOTargetMemberConnectionType");
}

void DOMemberTargetObjectClass::Publish()
{
  if (!mPublished)
  {
    rti1516ev::AttributeHandleSet attributes = GetAllAttributeHandles();
    mRtiAmbassador->publishObjectClassAttributes(mObjectClassHandle, attributes);
    mPublished = true;
  }
}

void DOMemberTargetObjectClass::Unpublish()
{
  if (mPublished)
  {
    mRtiAmbassador->unpublishObjectClass(mObjectClassHandle);
    mPublished = false;
  }
}

void DOMemberTargetObjectClass::Subscribe()
{
  if (!mSubscribed)
  {
    rti1516ev::AttributeHandleSet attributes = GetAllAttributeHandles();
    mRtiAmbassador->subscribeObjectClassAttributes(mObjectClassHandle, attributes);
    mRtiAmbassador->setObjectClassDeliverToSelf(mObjectClassHandle, true);
    mSubscribed = true;
  }
}

void DOMemberTargetObjectClass::Unsubscribe()
{
  if (mSubscribed)
  {
    mRtiAmbassador->unsubscribeObjectClass(mObjectClassHandle);
    mSubscribed = false;
  }
}

void DOMemberTargetObjectClass::DiscoverObjectInstance(rti1516ev::ObjectInstanceHandle instanceHandle, const std::wstring& instanceName)
{
  assert(mObjectInstancesByName.find(instanceName) == mObjectInstancesByName.end());
  assert(mObjectInstancesByHandle.find(instanceHandle) == mObjectInstancesByHandle.end());
  DOMemberTarget* newObject = new DOMemberTarget(this, instanceName, mRtiAmbassador);
  newObject->mObjectInstanceHandle = instanceHandle;
  newObject->mIsOwner = false;
  mObjectInstancesByName.insert(std::make_pair(instanceName, newObject));
  mObjectInstancesByHandle.insert(std::make_pair(instanceHandle, newObject));
}

void DOMemberTargetObjectClass::RemoveObjectInstance(rti1516ev::ObjectInstanceHandle theObject)
{
  std::wstring instanceName = mRtiAmbassador->getObjectInstanceName(theObject);
  auto iter = mObjectInstancesByName.find(instanceName);
  assert(iter != mObjectInstancesByName.end());
  auto* objectInstance = iter->second;
  objectInstance->mObjectInstanceHandle = rti1516ev::ObjectInstanceHandle();
  mObjectInstancesByName.erase(iter);
  mObjectInstancesByHandle.erase(theObject);
}

IDOMemberTarget* DOMemberTargetObjectClass::GetObjectInstance(const std::wstring& instanceName)
{
  auto iter = mObjectInstancesByName.find(instanceName);
  if (iter != mObjectInstancesByName.end())
  {
    return iter->second;
  }
  else
  {
    return nullptr;
  }
}

IDOMemberTarget* DOMemberTargetObjectClass::GetObjectInstance(rti1516ev::ObjectInstanceHandle instanceHandle)
{
  auto iter = mObjectInstancesByHandle.find(instanceHandle);
  if (iter != mObjectInstancesByHandle.end())
  {
    return iter->second;
  }
  else
  {
    return nullptr;
  }
}

IDOMemberTarget* DOMemberTargetObjectClass::CreateObjectInstance(const std::wstring& instanceName)
{
  auto iter = mObjectInstancesByName.find(instanceName);
  if (iter != mObjectInstancesByName.end())
  {
    return nullptr;
  }
  if (!mPublished)
  {
    throw rti1516ev::ObjectClassNotPublished(L"DOMemberTarget");
  }
  DOMemberTarget* newObject = new DOMemberTarget(this, instanceName, mRtiAmbassador);
  ObjectClassRegistry::GetInstance()->RegisterObjectInstanceName(instanceName, [this, newObject, instanceName](bool success) {
    if (success) {
      rti1516ev::ObjectInstanceHandle instanceHandle = mRtiAmbassador->registerObjectInstance(mObjectClassHandle, instanceName);
      newObject->mObjectInstanceHandle = instanceHandle;
      newObject->mIsOwner = true;
      mObjectInstancesByHandle.insert(std::make_pair(instanceHandle, newObject));
    }
  });
  mObjectInstancesByName.insert(std::make_pair(instanceName, newObject));
  return newObject;
}

rti1516ev::AttributeHandleSet DOMemberTargetObjectClass::GetAllAttributeHandles()
{
  rti1516ev::AttributeHandleSet result;
  result.insert(GetDOTargetMemberNameAttributeHandle());
  result.insert(GetDOTargetMemberConnectionTypeAttributeHandle());
  return result;
}

// object instances of type 'DOMemberTarget'
DOMemberTarget::DOMemberTarget()
{
}

DOMemberTarget::DOMemberTarget(DOMemberTargetObjectClass* objectClass, const std::wstring& instanceName, rti1516ev::RTIambassador* rtiAmbassador)
  : mObjectClass(objectClass)
  , mInstanceName(instanceName)
  , mRtiAmbassador(rtiAmbassador)
{
}

DOMemberTarget::~DOMemberTarget()
{
  if (mObjectInstanceHandle.isValid() && mIsOwner)
  {
    mRtiAmbassador->deleteObjectInstance(mObjectInstanceHandle, rti1516ev::VariableLengthData());
    mObjectInstanceHandle = rti1516ev::ObjectInstanceHandle();
    mIsOwner = false;
  }
}

// attribute DOMemberTarget.HLAprivilegeToDeleteObject : no data type

// attribute DOTargetMemberName : HLAASCIIstring
std::string DOMemberTarget::GetDOTargetMemberName() const
{
  return mDOTargetMemberName.get();
}

void DOMemberTarget::SetDOTargetMemberName(std::string newValue)
{
  mDOTargetMemberName.set(newValue);
  mDirty |= kDOTargetMemberNameBit;
}

// attribute DOTargetMemberConnectionType : HLAASCIIstring
std::string DOMemberTarget::GetDOTargetMemberConnectionType() const
{
  return mDOTargetMemberConnectionType.get();
}

void DOMemberTarget::SetDOTargetMemberConnectionType(std::string newValue)
{
  mDOTargetMemberConnectionType.set(newValue);
  mDirty |= kDOTargetMemberConnectionTypeBit;
}

rti1516ev::AttributeHandleValueMap DOMemberTarget::GetAllAttributeValues() const
{
  rti1516ev::AttributeHandleValueMap result;
  result[mObjectClass->GetDOTargetMemberNameAttributeHandle()] = mDOTargetMemberName.encode();
  result[mObjectClass->GetDOTargetMemberConnectionTypeAttributeHandle()] = mDOTargetMemberConnectionType.encode();
  return result;
}

rti1516ev::AttributeHandleValueMap DOMemberTarget::GetModifiedAttributeValues() const
{
  rti1516ev::AttributeHandleValueMap result;
  if (mDirty & kDOTargetMemberNameBit)
  {
    result[mObjectClass->GetDOTargetMemberNameAttributeHandle()] = mDOTargetMemberName.encode();
  }
  if (mDirty & kDOTargetMemberConnectionTypeBit)
  {
    result[mObjectClass->GetDOTargetMemberConnectionTypeAttributeHandle()] = mDOTargetMemberConnectionType.encode();
  }
  return result;
}

void DOMemberTarget::UpdateAllAttributeValues()
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetAllAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData());
  }
}

void DOMemberTarget::UpdateAllAttributeValues(const rti1516ev::LogicalTime& time)
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetAllAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData(), time);
  }
}

void DOMemberTarget::UpdateModifiedAttributeValues()
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetModifiedAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData());
    mDirty = kNone;
  }
}

void DOMemberTarget::UpdateModifiedAttributeValues(const rti1516ev::LogicalTime& time)
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetModifiedAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData(), time);
    mDirty = kNone;
  }
}

void DOMemberTarget::ReflectAttributeValues(const rti1516ev::AttributeHandleValueMap& attributes)
{
  for (auto& attributeHandleValue : attributes)
  {
    rti1516ev::AttributeHandle attributeHandle = attributeHandleValue.first;
    if (attributeHandle == mObjectClass->GetDOTargetMemberNameAttributeHandle())
    {
      mDOTargetMemberName.decode(attributeHandleValue.second);
      mLastUpdated |= kDOTargetMemberNameBit;
    }
    else if (attributeHandle == mObjectClass->GetDOTargetMemberConnectionTypeAttributeHandle())
    {
      mDOTargetMemberConnectionType.decode(attributeHandleValue.second);
      mLastUpdated |= kDOTargetMemberConnectionTypeBit;
    }
  } // for (auto& attributeHandleValue : attributes)
    ExecuteUpdateCallbacks();
} // DOMemberTarget::ReflectAttributeValues

void DOMemberTarget::ProvideAttributeValues(const rti1516ev::AttributeHandleSet& attributeHandles)
{
  rti1516ev::AttributeHandleValueMap updateAttributes;
  for (auto& attributeHandle : attributeHandles)
  {
    if (attributeHandle == mObjectClass->GetDOTargetMemberNameAttributeHandle())
    {
      updateAttributes.insert(std::make_pair(attributeHandle, mDOTargetMemberName.encode()));
      mDirty &= ~kDOTargetMemberNameBit;
    }
    else if (attributeHandle == mObjectClass->GetDOTargetMemberConnectionTypeAttributeHandle())
    {
      updateAttributes.insert(std::make_pair(attributeHandle, mDOTargetMemberConnectionType.encode()));
      mDirty &= ~kDOTargetMemberConnectionTypeBit;
    }
  } // for (auto& attributeHandleValue : attributes)
  mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, updateAttributes, rti1516ev::VariableLengthData());
} // DOMemberTarget::ReflectAttributeValues

uint32_t DOMemberTarget::RegisterUpdateCallback(UpdateCallbackType callback)
{
  mLastCallbackToken++;
  mUpdateCallbacks.insert(std::make_pair(mLastCallbackToken, callback));
  return mLastCallbackToken;
}

void DOMemberTarget::UnregisterUpdateCallback(uint32_t callbackToken)
{
  mUpdateCallbacks.erase(callbackToken);
}

void DOMemberTarget::ExecuteUpdateCallbacks()
{
  for (auto& callbackEntry : mUpdateCallbacks)
  {
    auto& callback = callbackEntry.second;
    callback(this);
  }
}

// object class type 'BusManagement'
BusManagementObjectClass::BusManagementObjectClass(rti1516ev::RTIambassador* rtiAmbassador, HLAobjectRootObjectClass* baseClass)
{
  mRtiAmbassador = rtiAmbassador;
  mBaseClass = baseClass;
  mObjectClassHandle = rtiAmbassador->getObjectClassHandle(L"HLAobjectRoot.BusManagement");
  // attribute NetworkID : HLAASCIIstring
  mNetworkIDAttributeHandle = rtiAmbassador->getAttributeHandle(mObjectClassHandle, L"NetworkID");
}

void BusManagementObjectClass::Publish()
{
  if (!mPublished)
  {
    rti1516ev::AttributeHandleSet attributes = GetAllAttributeHandles();
    mRtiAmbassador->publishObjectClassAttributes(mObjectClassHandle, attributes);
    mPublished = true;
  }
}

void BusManagementObjectClass::Unpublish()
{
  if (mPublished)
  {
    mRtiAmbassador->unpublishObjectClass(mObjectClassHandle);
    mPublished = false;
  }
}

void BusManagementObjectClass::Subscribe()
{
  if (!mSubscribed)
  {
    rti1516ev::AttributeHandleSet attributes = GetAllAttributeHandles();
    mRtiAmbassador->subscribeObjectClassAttributes(mObjectClassHandle, attributes);
    mRtiAmbassador->setObjectClassDeliverToSelf(mObjectClassHandle, true);
    mSubscribed = true;
  }
}

void BusManagementObjectClass::Unsubscribe()
{
  if (mSubscribed)
  {
    mRtiAmbassador->unsubscribeObjectClass(mObjectClassHandle);
    mSubscribed = false;
  }
}

void BusManagementObjectClass::DiscoverObjectInstance(rti1516ev::ObjectInstanceHandle instanceHandle, const std::wstring& instanceName)
{
  assert(mObjectInstancesByName.find(instanceName) == mObjectInstancesByName.end());
  assert(mObjectInstancesByHandle.find(instanceHandle) == mObjectInstancesByHandle.end());
  BusManagement* newObject = new BusManagement(this, instanceName, mRtiAmbassador);
  newObject->mObjectInstanceHandle = instanceHandle;
  newObject->mIsOwner = false;
  mObjectInstancesByName.insert(std::make_pair(instanceName, newObject));
  mObjectInstancesByHandle.insert(std::make_pair(instanceHandle, newObject));
}

void BusManagementObjectClass::RemoveObjectInstance(rti1516ev::ObjectInstanceHandle theObject)
{
  std::wstring instanceName = mRtiAmbassador->getObjectInstanceName(theObject);
  auto iter = mObjectInstancesByName.find(instanceName);
  assert(iter != mObjectInstancesByName.end());
  auto* objectInstance = iter->second;
  objectInstance->mObjectInstanceHandle = rti1516ev::ObjectInstanceHandle();
  mObjectInstancesByName.erase(iter);
  mObjectInstancesByHandle.erase(theObject);
}

IBusManagement* BusManagementObjectClass::GetObjectInstance(const std::wstring& instanceName)
{
  auto iter = mObjectInstancesByName.find(instanceName);
  if (iter != mObjectInstancesByName.end())
  {
    return iter->second;
  }
  else
  {
    return nullptr;
  }
}

IBusManagement* BusManagementObjectClass::GetObjectInstance(rti1516ev::ObjectInstanceHandle instanceHandle)
{
  auto iter = mObjectInstancesByHandle.find(instanceHandle);
  if (iter != mObjectInstancesByHandle.end())
  {
    return iter->second;
  }
  else
  {
    return nullptr;
  }
}

IBusManagement* BusManagementObjectClass::CreateObjectInstance(const std::wstring& instanceName)
{
  auto iter = mObjectInstancesByName.find(instanceName);
  if (iter != mObjectInstancesByName.end())
  {
    return nullptr;
  }
  if (!mPublished)
  {
    throw rti1516ev::ObjectClassNotPublished(L"BusManagement");
  }
  BusManagement* newObject = new BusManagement(this, instanceName, mRtiAmbassador);
  ObjectClassRegistry::GetInstance()->RegisterObjectInstanceName(instanceName, [this, newObject, instanceName](bool success) {
    if (success) {
      rti1516ev::ObjectInstanceHandle instanceHandle = mRtiAmbassador->registerObjectInstance(mObjectClassHandle, instanceName);
      newObject->mObjectInstanceHandle = instanceHandle;
      newObject->mIsOwner = true;
      mObjectInstancesByHandle.insert(std::make_pair(instanceHandle, newObject));
    }
  });
  mObjectInstancesByName.insert(std::make_pair(instanceName, newObject));
  return newObject;
}

rti1516ev::AttributeHandleSet BusManagementObjectClass::GetAllAttributeHandles()
{
  rti1516ev::AttributeHandleSet result;
  result.insert(GetNetworkIDAttributeHandle());
  return result;
}

// object instances of type 'BusManagement'
BusManagement::BusManagement()
{
}

BusManagement::BusManagement(BusManagementObjectClass* objectClass, const std::wstring& instanceName, rti1516ev::RTIambassador* rtiAmbassador)
  : mObjectClass(objectClass)
  , mInstanceName(instanceName)
  , mRtiAmbassador(rtiAmbassador)
{
}

BusManagement::~BusManagement()
{
  if (mObjectInstanceHandle.isValid() && mIsOwner)
  {
    mRtiAmbassador->deleteObjectInstance(mObjectInstanceHandle, rti1516ev::VariableLengthData());
    mObjectInstanceHandle = rti1516ev::ObjectInstanceHandle();
    mIsOwner = false;
  }
}

// attribute BusManagement.HLAprivilegeToDeleteObject : no data type

// attribute NetworkID : HLAASCIIstring
std::string BusManagement::GetNetworkID() const
{
  return mNetworkID.get();
}

void BusManagement::SetNetworkID(std::string newValue)
{
  mNetworkID.set(newValue);
  mDirty |= kNetworkIDBit;
}

rti1516ev::AttributeHandleValueMap BusManagement::GetAllAttributeValues() const
{
  rti1516ev::AttributeHandleValueMap result;
  result[mObjectClass->GetNetworkIDAttributeHandle()] = mNetworkID.encode();
  return result;
}

rti1516ev::AttributeHandleValueMap BusManagement::GetModifiedAttributeValues() const
{
  rti1516ev::AttributeHandleValueMap result;
  if (mDirty & kNetworkIDBit)
  {
    result[mObjectClass->GetNetworkIDAttributeHandle()] = mNetworkID.encode();
  }
  return result;
}

void BusManagement::UpdateAllAttributeValues()
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetAllAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData());
  }
}

void BusManagement::UpdateAllAttributeValues(const rti1516ev::LogicalTime& time)
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetAllAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData(), time);
  }
}

void BusManagement::UpdateModifiedAttributeValues()
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetModifiedAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData());
    mDirty = kNone;
  }
}

void BusManagement::UpdateModifiedAttributeValues(const rti1516ev::LogicalTime& time)
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetModifiedAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData(), time);
    mDirty = kNone;
  }
}

void BusManagement::ReflectAttributeValues(const rti1516ev::AttributeHandleValueMap& attributes)
{
  for (auto& attributeHandleValue : attributes)
  {
    rti1516ev::AttributeHandle attributeHandle = attributeHandleValue.first;
    if (attributeHandle == mObjectClass->GetNetworkIDAttributeHandle())
    {
      mNetworkID.decode(attributeHandleValue.second);
      mLastUpdated |= kNetworkIDBit;
    }
  } // for (auto& attributeHandleValue : attributes)
} // BusManagement::ReflectAttributeValues

void BusManagement::ProvideAttributeValues(const rti1516ev::AttributeHandleSet& attributeHandles)
{
  rti1516ev::AttributeHandleValueMap updateAttributes;
  for (auto& attributeHandle : attributeHandles)
  {
    if (attributeHandle == mObjectClass->GetNetworkIDAttributeHandle())
    {
      updateAttributes.insert(std::make_pair(attributeHandle, mNetworkID.encode()));
      mDirty &= ~kNetworkIDBit;
    }
  } // for (auto& attributeHandleValue : attributes)
  mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, updateAttributes, rti1516ev::VariableLengthData());
} // BusManagement::ReflectAttributeValues


// object class type 'BusManagementCan'
BusManagementCanObjectClass::BusManagementCanObjectClass(rti1516ev::RTIambassador* rtiAmbassador, BusManagementObjectClass* baseClass)
{
  mRtiAmbassador = rtiAmbassador;
  mBaseClass = baseClass;
  mObjectClassHandle = rtiAmbassador->getObjectClassHandle(L"HLAobjectRoot.BusManagement.BusManagementCan");
  // attribute BusState : CanBusState
  mBusStateAttributeHandle = rtiAmbassador->getAttributeHandle(mObjectClassHandle, L"BusState");
  // attribute TxErrorCount : HLAinteger32LE
  mTxErrorCountAttributeHandle = rtiAmbassador->getAttributeHandle(mObjectClassHandle, L"TxErrorCount");
  // attribute RxErrorCount : HLAinteger32LE
  mRxErrorCountAttributeHandle = rtiAmbassador->getAttributeHandle(mObjectClassHandle, L"RxErrorCount");
  // attribute SendMessagesAsRx : HLAboolean
  mSendMessagesAsRxAttributeHandle = rtiAmbassador->getAttributeHandle(mObjectClassHandle, L"SendMessagesAsRx");
}

void BusManagementCanObjectClass::Publish()
{
  if (!mPublished)
  {
    rti1516ev::AttributeHandleSet attributes = GetAllAttributeHandles();
    mRtiAmbassador->publishObjectClassAttributes(mObjectClassHandle, attributes);
    mPublished = true;
  }
}

void BusManagementCanObjectClass::Unpublish()
{
  if (mPublished)
  {
    mRtiAmbassador->unpublishObjectClass(mObjectClassHandle);
    mPublished = false;
  }
}

void BusManagementCanObjectClass::Subscribe()
{
  if (!mSubscribed)
  {
    rti1516ev::AttributeHandleSet attributes = GetAllAttributeHandles();
    mRtiAmbassador->subscribeObjectClassAttributes(mObjectClassHandle, attributes);
    mRtiAmbassador->setObjectClassDeliverToSelf(mObjectClassHandle, true);
    mSubscribed = true;
  }
}

void BusManagementCanObjectClass::Unsubscribe()
{
  if (mSubscribed)
  {
    mRtiAmbassador->unsubscribeObjectClass(mObjectClassHandle);
    mSubscribed = false;
  }
}

void BusManagementCanObjectClass::DiscoverObjectInstance(rti1516ev::ObjectInstanceHandle instanceHandle, const std::wstring& instanceName)
{
  assert(mObjectInstancesByName.find(instanceName) == mObjectInstancesByName.end());
  assert(mObjectInstancesByHandle.find(instanceHandle) == mObjectInstancesByHandle.end());
  BusManagementCan* newObject = new BusManagementCan(this, instanceName, mRtiAmbassador);
  newObject->mObjectInstanceHandle = instanceHandle;
  newObject->mIsOwner = false;
  mObjectInstancesByName.insert(std::make_pair(instanceName, newObject));
  mObjectInstancesByHandle.insert(std::make_pair(instanceHandle, newObject));
}

void BusManagementCanObjectClass::RemoveObjectInstance(rti1516ev::ObjectInstanceHandle theObject)
{
  std::wstring instanceName = mRtiAmbassador->getObjectInstanceName(theObject);
  auto iter = mObjectInstancesByName.find(instanceName);
  assert(iter != mObjectInstancesByName.end());
  auto* objectInstance = iter->second;
  objectInstance->mObjectInstanceHandle = rti1516ev::ObjectInstanceHandle();
  mObjectInstancesByName.erase(iter);
  mObjectInstancesByHandle.erase(theObject);
}

IBusManagementCan* BusManagementCanObjectClass::GetObjectInstance(const std::wstring& instanceName)
{
  auto iter = mObjectInstancesByName.find(instanceName);
  if (iter != mObjectInstancesByName.end())
  {
    return iter->second;
  }
  else
  {
    return nullptr;
  }
}

IBusManagementCan* BusManagementCanObjectClass::GetObjectInstance(rti1516ev::ObjectInstanceHandle instanceHandle)
{
  auto iter = mObjectInstancesByHandle.find(instanceHandle);
  if (iter != mObjectInstancesByHandle.end())
  {
    return iter->second;
  }
  else
  {
    return nullptr;
  }
}

IBusManagementCan* BusManagementCanObjectClass::CreateObjectInstance(const std::wstring& instanceName)
{
  auto iter = mObjectInstancesByName.find(instanceName);
  if (iter != mObjectInstancesByName.end())
  {
    return nullptr;
  }
  if (!mPublished)
  {
    throw rti1516ev::ObjectClassNotPublished(L"BusManagementCan");
  }
  BusManagementCan* newObject = new BusManagementCan(this, instanceName, mRtiAmbassador);
  ObjectClassRegistry::GetInstance()->RegisterObjectInstanceName(instanceName, [this, newObject, instanceName](bool success) {
    if (success) {
      rti1516ev::ObjectInstanceHandle instanceHandle = mRtiAmbassador->registerObjectInstance(mObjectClassHandle, instanceName);
      newObject->mObjectInstanceHandle = instanceHandle;
      newObject->mIsOwner = true;
      mObjectInstancesByHandle.insert(std::make_pair(instanceHandle, newObject));
    }
  });
  mObjectInstancesByName.insert(std::make_pair(instanceName, newObject));
  return newObject;
}

rti1516ev::AttributeHandleSet BusManagementCanObjectClass::GetAllAttributeHandles()
{
  rti1516ev::AttributeHandleSet result;
  result.insert(GetNetworkIDAttributeHandle());
  result.insert(GetBusStateAttributeHandle());
  result.insert(GetTxErrorCountAttributeHandle());
  result.insert(GetRxErrorCountAttributeHandle());
  result.insert(GetSendMessagesAsRxAttributeHandle());
  return result;
}

// object instances of type 'BusManagementCan'
BusManagementCan::BusManagementCan()
{
}

BusManagementCan::BusManagementCan(BusManagementCanObjectClass* objectClass, const std::wstring& instanceName, rti1516ev::RTIambassador* rtiAmbassador)
  : mObjectClass(objectClass)
  , mInstanceName(instanceName)
  , mRtiAmbassador(rtiAmbassador)
{
}

BusManagementCan::~BusManagementCan()
{
  if (mObjectInstanceHandle.isValid() && mIsOwner)
  {
    mRtiAmbassador->deleteObjectInstance(mObjectInstanceHandle, rti1516ev::VariableLengthData());
    mObjectInstanceHandle = rti1516ev::ObjectInstanceHandle();
    mIsOwner = false;
  }
}

// attribute BusManagementCan.HLAprivilegeToDeleteObject : no data type

// attribute NetworkID : HLAASCIIstring
std::string BusManagementCan::GetNetworkID() const
{
  return mNetworkID.get();
}

void BusManagementCan::SetNetworkID(std::string newValue)
{
  mNetworkID.set(newValue);
  mDirty |= kNetworkIDBit;
}

// attribute BusState : CanBusState
CanBusState BusManagementCan::GetBusState() const
{
  return static_cast<CanBusState>(mBusState.get());
}

void BusManagementCan::SetBusState(CanBusState newValue)
{
  mBusState.set(newValue);
  mDirty |= kBusStateBit;
}

// attribute TxErrorCount : HLAinteger32LE
int32_t BusManagementCan::GetTxErrorCount() const
{
  return mTxErrorCount.get();
}

void BusManagementCan::SetTxErrorCount(int32_t newValue)
{
  mTxErrorCount.set(newValue);
  mDirty |= kTxErrorCountBit;
}

// attribute RxErrorCount : HLAinteger32LE
int32_t BusManagementCan::GetRxErrorCount() const
{
  return mRxErrorCount.get();
}

void BusManagementCan::SetRxErrorCount(int32_t newValue)
{
  mRxErrorCount.set(newValue);
  mDirty |= kRxErrorCountBit;
}

// attribute SendMessagesAsRx : HLAboolean
bool BusManagementCan::GetSendMessagesAsRx() const
{
  return mSendMessagesAsRx.get();
}

void BusManagementCan::SetSendMessagesAsRx(bool newValue)
{
  mSendMessagesAsRx.set(newValue);
  mDirty |= kSendMessagesAsRxBit;
}

rti1516ev::AttributeHandleValueMap BusManagementCan::GetAllAttributeValues() const
{
  rti1516ev::AttributeHandleValueMap result;
  result[mObjectClass->GetNetworkIDAttributeHandle()] = mNetworkID.encode();
  result[mObjectClass->GetBusStateAttributeHandle()] = mBusState.encode();
  result[mObjectClass->GetTxErrorCountAttributeHandle()] = mTxErrorCount.encode();
  result[mObjectClass->GetRxErrorCountAttributeHandle()] = mRxErrorCount.encode();
  result[mObjectClass->GetSendMessagesAsRxAttributeHandle()] = mSendMessagesAsRx.encode();
  return result;
}

rti1516ev::AttributeHandleValueMap BusManagementCan::GetModifiedAttributeValues() const
{
  rti1516ev::AttributeHandleValueMap result;
  if (mDirty & kBusStateBit)
  {
    result[mObjectClass->GetBusStateAttributeHandle()] = mBusState.encode();
  }
  if (mDirty & kTxErrorCountBit)
  {
    result[mObjectClass->GetTxErrorCountAttributeHandle()] = mTxErrorCount.encode();
  }
  if (mDirty & kRxErrorCountBit)
  {
    result[mObjectClass->GetRxErrorCountAttributeHandle()] = mRxErrorCount.encode();
  }
  if (mDirty & kSendMessagesAsRxBit)
  {
    result[mObjectClass->GetSendMessagesAsRxAttributeHandle()] = mSendMessagesAsRx.encode();
  }
  return result;
}

void BusManagementCan::UpdateAllAttributeValues()
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetAllAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData());
  }
}

void BusManagementCan::UpdateAllAttributeValues(const rti1516ev::LogicalTime& time)
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetAllAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData(), time);
  }
}

void BusManagementCan::UpdateModifiedAttributeValues()
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetModifiedAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData());
    mDirty = kNone;
  }
}

void BusManagementCan::UpdateModifiedAttributeValues(const rti1516ev::LogicalTime& time)
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetModifiedAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData(), time);
    mDirty = kNone;
  }
}

void BusManagementCan::ReflectAttributeValues(const rti1516ev::AttributeHandleValueMap& attributes)
{
  for (auto& attributeHandleValue : attributes)
  {
    rti1516ev::AttributeHandle attributeHandle = attributeHandleValue.first;
    if (attributeHandle == mObjectClass->GetBusStateAttributeHandle())
    {
      mBusState.decode(attributeHandleValue.second);
      mLastUpdated |= kBusStateBit;
    }
    else if (attributeHandle == mObjectClass->GetTxErrorCountAttributeHandle())
    {
      mTxErrorCount.decode(attributeHandleValue.second);
      mLastUpdated |= kTxErrorCountBit;
    }
    else if (attributeHandle == mObjectClass->GetRxErrorCountAttributeHandle())
    {
      mRxErrorCount.decode(attributeHandleValue.second);
      mLastUpdated |= kRxErrorCountBit;
    }
    else if (attributeHandle == mObjectClass->GetSendMessagesAsRxAttributeHandle())
    {
      mSendMessagesAsRx.decode(attributeHandleValue.second);
      mLastUpdated |= kSendMessagesAsRxBit;
    }
  } // for (auto& attributeHandleValue : attributes)
    ExecuteUpdateCallbacks();
} // BusManagementCan::ReflectAttributeValues

void BusManagementCan::ProvideAttributeValues(const rti1516ev::AttributeHandleSet& attributeHandles)
{
  rti1516ev::AttributeHandleValueMap updateAttributes;
  for (auto& attributeHandle : attributeHandles)
  {
    if (attributeHandle == mObjectClass->GetBusStateAttributeHandle())
    {
      updateAttributes.insert(std::make_pair(attributeHandle, mBusState.encode()));
      mDirty &= ~kBusStateBit;
    }
    else if (attributeHandle == mObjectClass->GetTxErrorCountAttributeHandle())
    {
      updateAttributes.insert(std::make_pair(attributeHandle, mTxErrorCount.encode()));
      mDirty &= ~kTxErrorCountBit;
    }
    else if (attributeHandle == mObjectClass->GetRxErrorCountAttributeHandle())
    {
      updateAttributes.insert(std::make_pair(attributeHandle, mRxErrorCount.encode()));
      mDirty &= ~kRxErrorCountBit;
    }
    else if (attributeHandle == mObjectClass->GetSendMessagesAsRxAttributeHandle())
    {
      updateAttributes.insert(std::make_pair(attributeHandle, mSendMessagesAsRx.encode()));
      mDirty &= ~kSendMessagesAsRxBit;
    }
  } // for (auto& attributeHandleValue : attributes)
  mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, updateAttributes, rti1516ev::VariableLengthData());
} // BusManagementCan::ReflectAttributeValues

uint32_t BusManagementCan::RegisterUpdateCallback(UpdateCallbackType callback)
{
  mLastCallbackToken++;
  mUpdateCallbacks.insert(std::make_pair(mLastCallbackToken, callback));
  return mLastCallbackToken;
}

void BusManagementCan::UnregisterUpdateCallback(uint32_t callbackToken)
{
  mUpdateCallbacks.erase(callbackToken);
}

void BusManagementCan::ExecuteUpdateCallbacks()
{
  for (auto& callbackEntry : mUpdateCallbacks)
  {
    auto& callback = callbackEntry.second;
    callback(this);
  }
}

// object class type 'BusController'
BusControllerObjectClass::BusControllerObjectClass(rti1516ev::RTIambassador* rtiAmbassador, HLAobjectRootObjectClass* baseClass)
{
  mRtiAmbassador = rtiAmbassador;
  mBaseClass = baseClass;
  mObjectClassHandle = rtiAmbassador->getObjectClassHandle(L"HLAobjectRoot.BusController");
  // attribute NetworkID : HLAASCIIstring
  mNetworkIDAttributeHandle = rtiAmbassador->getAttributeHandle(mObjectClassHandle, L"NetworkID");
  // attribute DeviceID : HLAASCIIstring
  mDeviceIDAttributeHandle = rtiAmbassador->getAttributeHandle(mObjectClassHandle, L"DeviceID");
}

void BusControllerObjectClass::Publish()
{
  if (!mPublished)
  {
    rti1516ev::AttributeHandleSet attributes = GetAllAttributeHandles();
    mRtiAmbassador->publishObjectClassAttributes(mObjectClassHandle, attributes);
    mPublished = true;
  }
}

void BusControllerObjectClass::Unpublish()
{
  if (mPublished)
  {
    mRtiAmbassador->unpublishObjectClass(mObjectClassHandle);
    mPublished = false;
  }
}

void BusControllerObjectClass::Subscribe()
{
  if (!mSubscribed)
  {
    rti1516ev::AttributeHandleSet attributes = GetAllAttributeHandles();
    mRtiAmbassador->subscribeObjectClassAttributes(mObjectClassHandle, attributes);
    mRtiAmbassador->setObjectClassDeliverToSelf(mObjectClassHandle, true);
    mSubscribed = true;
  }
}

void BusControllerObjectClass::Unsubscribe()
{
  if (mSubscribed)
  {
    mRtiAmbassador->unsubscribeObjectClass(mObjectClassHandle);
    mSubscribed = false;
  }
}

void BusControllerObjectClass::DiscoverObjectInstance(rti1516ev::ObjectInstanceHandle instanceHandle, const std::wstring& instanceName)
{
  assert(mObjectInstancesByName.find(instanceName) == mObjectInstancesByName.end());
  assert(mObjectInstancesByHandle.find(instanceHandle) == mObjectInstancesByHandle.end());
  BusController* newObject = new BusController(this, instanceName, mRtiAmbassador);
  newObject->mObjectInstanceHandle = instanceHandle;
  newObject->mIsOwner = false;
  mObjectInstancesByName.insert(std::make_pair(instanceName, newObject));
  mObjectInstancesByHandle.insert(std::make_pair(instanceHandle, newObject));
}

void BusControllerObjectClass::RemoveObjectInstance(rti1516ev::ObjectInstanceHandle theObject)
{
  std::wstring instanceName = mRtiAmbassador->getObjectInstanceName(theObject);
  auto iter = mObjectInstancesByName.find(instanceName);
  assert(iter != mObjectInstancesByName.end());
  auto* objectInstance = iter->second;
  objectInstance->mObjectInstanceHandle = rti1516ev::ObjectInstanceHandle();
  mObjectInstancesByName.erase(iter);
  mObjectInstancesByHandle.erase(theObject);
}

IBusController* BusControllerObjectClass::GetObjectInstance(const std::wstring& instanceName)
{
  auto iter = mObjectInstancesByName.find(instanceName);
  if (iter != mObjectInstancesByName.end())
  {
    return iter->second;
  }
  else
  {
    return nullptr;
  }
}

IBusController* BusControllerObjectClass::GetObjectInstance(rti1516ev::ObjectInstanceHandle instanceHandle)
{
  auto iter = mObjectInstancesByHandle.find(instanceHandle);
  if (iter != mObjectInstancesByHandle.end())
  {
    return iter->second;
  }
  else
  {
    return nullptr;
  }
}

IBusController* BusControllerObjectClass::CreateObjectInstance(const std::wstring& instanceName)
{
  auto iter = mObjectInstancesByName.find(instanceName);
  if (iter != mObjectInstancesByName.end())
  {
    return nullptr;
  }
  if (!mPublished)
  {
    throw rti1516ev::ObjectClassNotPublished(L"BusController");
  }
  BusController* newObject = new BusController(this, instanceName, mRtiAmbassador);
  ObjectClassRegistry::GetInstance()->RegisterObjectInstanceName(instanceName, [this, newObject, instanceName](bool success) {
    if (success) {
      rti1516ev::ObjectInstanceHandle instanceHandle = mRtiAmbassador->registerObjectInstance(mObjectClassHandle, instanceName);
      newObject->mObjectInstanceHandle = instanceHandle;
      newObject->mIsOwner = true;
      mObjectInstancesByHandle.insert(std::make_pair(instanceHandle, newObject));
    }
  });
  mObjectInstancesByName.insert(std::make_pair(instanceName, newObject));
  return newObject;
}

rti1516ev::AttributeHandleSet BusControllerObjectClass::GetAllAttributeHandles()
{
  rti1516ev::AttributeHandleSet result;
  result.insert(GetNetworkIDAttributeHandle());
  result.insert(GetDeviceIDAttributeHandle());
  return result;
}

// object instances of type 'BusController'
BusController::BusController()
{
}

BusController::BusController(BusControllerObjectClass* objectClass, const std::wstring& instanceName, rti1516ev::RTIambassador* rtiAmbassador)
  : mObjectClass(objectClass)
  , mInstanceName(instanceName)
  , mRtiAmbassador(rtiAmbassador)
{
}

BusController::~BusController()
{
  if (mObjectInstanceHandle.isValid() && mIsOwner)
  {
    mRtiAmbassador->deleteObjectInstance(mObjectInstanceHandle, rti1516ev::VariableLengthData());
    mObjectInstanceHandle = rti1516ev::ObjectInstanceHandle();
    mIsOwner = false;
  }
}

// attribute BusController.HLAprivilegeToDeleteObject : no data type

// attribute NetworkID : HLAASCIIstring
std::string BusController::GetNetworkID() const
{
  return mNetworkID.get();
}

void BusController::SetNetworkID(std::string newValue)
{
  mNetworkID.set(newValue);
  mDirty |= kNetworkIDBit;
}

// attribute DeviceID : HLAASCIIstring
std::string BusController::GetDeviceID() const
{
  return mDeviceID.get();
}

void BusController::SetDeviceID(std::string newValue)
{
  mDeviceID.set(newValue);
  mDirty |= kDeviceIDBit;
}

rti1516ev::AttributeHandleValueMap BusController::GetAllAttributeValues() const
{
  rti1516ev::AttributeHandleValueMap result;
  result[mObjectClass->GetNetworkIDAttributeHandle()] = mNetworkID.encode();
  result[mObjectClass->GetDeviceIDAttributeHandle()] = mDeviceID.encode();
  return result;
}

rti1516ev::AttributeHandleValueMap BusController::GetModifiedAttributeValues() const
{
  rti1516ev::AttributeHandleValueMap result;
  if (mDirty & kNetworkIDBit)
  {
    result[mObjectClass->GetNetworkIDAttributeHandle()] = mNetworkID.encode();
  }
  if (mDirty & kDeviceIDBit)
  {
    result[mObjectClass->GetDeviceIDAttributeHandle()] = mDeviceID.encode();
  }
  return result;
}

void BusController::UpdateAllAttributeValues()
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetAllAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData());
  }
}

void BusController::UpdateAllAttributeValues(const rti1516ev::LogicalTime& time)
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetAllAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData(), time);
  }
}

void BusController::UpdateModifiedAttributeValues()
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetModifiedAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData());
    mDirty = kNone;
  }
}

void BusController::UpdateModifiedAttributeValues(const rti1516ev::LogicalTime& time)
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetModifiedAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData(), time);
    mDirty = kNone;
  }
}

void BusController::ReflectAttributeValues(const rti1516ev::AttributeHandleValueMap& attributes)
{
  for (auto& attributeHandleValue : attributes)
  {
    rti1516ev::AttributeHandle attributeHandle = attributeHandleValue.first;
    if (attributeHandle == mObjectClass->GetNetworkIDAttributeHandle())
    {
      mNetworkID.decode(attributeHandleValue.second);
      mLastUpdated |= kNetworkIDBit;
    }
    else if (attributeHandle == mObjectClass->GetDeviceIDAttributeHandle())
    {
      mDeviceID.decode(attributeHandleValue.second);
      mLastUpdated |= kDeviceIDBit;
    }
  } // for (auto& attributeHandleValue : attributes)
} // BusController::ReflectAttributeValues

void BusController::ProvideAttributeValues(const rti1516ev::AttributeHandleSet& attributeHandles)
{
  rti1516ev::AttributeHandleValueMap updateAttributes;
  for (auto& attributeHandle : attributeHandles)
  {
    if (attributeHandle == mObjectClass->GetNetworkIDAttributeHandle())
    {
      updateAttributes.insert(std::make_pair(attributeHandle, mNetworkID.encode()));
      mDirty &= ~kNetworkIDBit;
    }
    else if (attributeHandle == mObjectClass->GetDeviceIDAttributeHandle())
    {
      updateAttributes.insert(std::make_pair(attributeHandle, mDeviceID.encode()));
      mDirty &= ~kDeviceIDBit;
    }
  } // for (auto& attributeHandleValue : attributes)
  mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, updateAttributes, rti1516ev::VariableLengthData());
} // BusController::ReflectAttributeValues


// object class type 'BusControllerCan'
BusControllerCanObjectClass::BusControllerCanObjectClass(rti1516ev::RTIambassador* rtiAmbassador, BusControllerObjectClass* baseClass)
{
  mRtiAmbassador = rtiAmbassador;
  mBaseClass = baseClass;
  mObjectClassHandle = rtiAmbassador->getObjectClassHandle(L"HLAobjectRoot.BusController.BusControllerCan");
  // attribute BaudRate : HLAinteger32LE
  mBaudRateAttributeHandle = rtiAmbassador->getAttributeHandle(mObjectClassHandle, L"BaudRate");
  // attribute DataBaudRate : HLAinteger32LE
  mDataBaudRateAttributeHandle = rtiAmbassador->getAttributeHandle(mObjectClassHandle, L"DataBaudRate");
  // attribute PreScaler : HLAinteger32LE
  mPreScalerAttributeHandle = rtiAmbassador->getAttributeHandle(mObjectClassHandle, L"PreScaler");
  // attribute OperationMode : CanOperationMode
  mOperationModeAttributeHandle = rtiAmbassador->getAttributeHandle(mObjectClassHandle, L"OperationMode");
  // attribute Sync_Seg : HLAinteger32LE
  mSync_SegAttributeHandle = rtiAmbassador->getAttributeHandle(mObjectClassHandle, L"Sync_Seg");
  // attribute Prop_Seg : HLAinteger32LE
  mProp_SegAttributeHandle = rtiAmbassador->getAttributeHandle(mObjectClassHandle, L"Prop_Seg");
  // attribute Phase_Seg1 : HLAinteger32LE
  mPhase_Seg1AttributeHandle = rtiAmbassador->getAttributeHandle(mObjectClassHandle, L"Phase_Seg1");
  // attribute Phase_Seg2 : HLAinteger32LE
  mPhase_Seg2AttributeHandle = rtiAmbassador->getAttributeHandle(mObjectClassHandle, L"Phase_Seg2");
  // attribute SamplingMode : CanSamplingMode
  mSamplingModeAttributeHandle = rtiAmbassador->getAttributeHandle(mObjectClassHandle, L"SamplingMode");
}

void BusControllerCanObjectClass::Publish()
{
  if (!mPublished)
  {
    rti1516ev::AttributeHandleSet attributes = GetAllAttributeHandles();
    mRtiAmbassador->publishObjectClassAttributes(mObjectClassHandle, attributes);
    mPublished = true;
  }
}

void BusControllerCanObjectClass::Unpublish()
{
  if (mPublished)
  {
    mRtiAmbassador->unpublishObjectClass(mObjectClassHandle);
    mPublished = false;
  }
}

void BusControllerCanObjectClass::Subscribe()
{
  if (!mSubscribed)
  {
    rti1516ev::AttributeHandleSet attributes = GetAllAttributeHandles();
    mRtiAmbassador->subscribeObjectClassAttributes(mObjectClassHandle, attributes);
    mRtiAmbassador->setObjectClassDeliverToSelf(mObjectClassHandle, true);
    mSubscribed = true;
  }
}

void BusControllerCanObjectClass::Unsubscribe()
{
  if (mSubscribed)
  {
    mRtiAmbassador->unsubscribeObjectClass(mObjectClassHandle);
    mSubscribed = false;
  }
}

void BusControllerCanObjectClass::DiscoverObjectInstance(rti1516ev::ObjectInstanceHandle instanceHandle, const std::wstring& instanceName)
{
  assert(mObjectInstancesByName.find(instanceName) == mObjectInstancesByName.end());
  assert(mObjectInstancesByHandle.find(instanceHandle) == mObjectInstancesByHandle.end());
  BusControllerCan* newObject = new BusControllerCan(this, instanceName, mRtiAmbassador);
  newObject->mObjectInstanceHandle = instanceHandle;
  newObject->mIsOwner = false;
  mObjectInstancesByName.insert(std::make_pair(instanceName, newObject));
  mObjectInstancesByHandle.insert(std::make_pair(instanceHandle, newObject));
}

void BusControllerCanObjectClass::RemoveObjectInstance(rti1516ev::ObjectInstanceHandle theObject)
{
  std::wstring instanceName = mRtiAmbassador->getObjectInstanceName(theObject);
  auto iter = mObjectInstancesByName.find(instanceName);
  assert(iter != mObjectInstancesByName.end());
  auto* objectInstance = iter->second;
  objectInstance->mObjectInstanceHandle = rti1516ev::ObjectInstanceHandle();
  mObjectInstancesByName.erase(iter);
  mObjectInstancesByHandle.erase(theObject);
}

IBusControllerCan* BusControllerCanObjectClass::GetObjectInstance(const std::wstring& instanceName)
{
  auto iter = mObjectInstancesByName.find(instanceName);
  if (iter != mObjectInstancesByName.end())
  {
    return iter->second;
  }
  else
  {
    return nullptr;
  }
}

IBusControllerCan* BusControllerCanObjectClass::GetObjectInstance(rti1516ev::ObjectInstanceHandle instanceHandle)
{
  auto iter = mObjectInstancesByHandle.find(instanceHandle);
  if (iter != mObjectInstancesByHandle.end())
  {
    return iter->second;
  }
  else
  {
    return nullptr;
  }
}

IBusControllerCan* BusControllerCanObjectClass::CreateObjectInstance(const std::wstring& instanceName)
{
  auto iter = mObjectInstancesByName.find(instanceName);
  if (iter != mObjectInstancesByName.end())
  {
    return nullptr;
  }
  if (!mPublished)
  {
    throw rti1516ev::ObjectClassNotPublished(L"BusControllerCan");
  }
  BusControllerCan* newObject = new BusControllerCan(this, instanceName, mRtiAmbassador);
  ObjectClassRegistry::GetInstance()->RegisterObjectInstanceName(instanceName, [this, newObject, instanceName](bool success) {
    if (success) {
      rti1516ev::ObjectInstanceHandle instanceHandle = mRtiAmbassador->registerObjectInstance(mObjectClassHandle, instanceName);
      newObject->mObjectInstanceHandle = instanceHandle;
      newObject->mIsOwner = true;
      mObjectInstancesByHandle.insert(std::make_pair(instanceHandle, newObject));
    }
  });
  mObjectInstancesByName.insert(std::make_pair(instanceName, newObject));
  return newObject;
}

rti1516ev::AttributeHandleSet BusControllerCanObjectClass::GetAllAttributeHandles()
{
  rti1516ev::AttributeHandleSet result;
  result.insert(GetNetworkIDAttributeHandle());
  result.insert(GetDeviceIDAttributeHandle());
  result.insert(GetBaudRateAttributeHandle());
  result.insert(GetDataBaudRateAttributeHandle());
  result.insert(GetPreScalerAttributeHandle());
  result.insert(GetOperationModeAttributeHandle());
  result.insert(GetSync_SegAttributeHandle());
  result.insert(GetProp_SegAttributeHandle());
  result.insert(GetPhase_Seg1AttributeHandle());
  result.insert(GetPhase_Seg2AttributeHandle());
  result.insert(GetSamplingModeAttributeHandle());
  return result;
}

// object instances of type 'BusControllerCan'
BusControllerCan::BusControllerCan()
{
}

BusControllerCan::BusControllerCan(BusControllerCanObjectClass* objectClass, const std::wstring& instanceName, rti1516ev::RTIambassador* rtiAmbassador)
  : mObjectClass(objectClass)
  , mInstanceName(instanceName)
  , mRtiAmbassador(rtiAmbassador)
{
}

BusControllerCan::~BusControllerCan()
{
  if (mObjectInstanceHandle.isValid() && mIsOwner)
  {
    mRtiAmbassador->deleteObjectInstance(mObjectInstanceHandle, rti1516ev::VariableLengthData());
    mObjectInstanceHandle = rti1516ev::ObjectInstanceHandle();
    mIsOwner = false;
  }
}

// attribute BusControllerCan.HLAprivilegeToDeleteObject : no data type

// attribute NetworkID : HLAASCIIstring
std::string BusControllerCan::GetNetworkID() const
{
  return mNetworkID.get();
}

void BusControllerCan::SetNetworkID(std::string newValue)
{
  mNetworkID.set(newValue);
  mDirty |= kNetworkIDBit;
}

// attribute DeviceID : HLAASCIIstring
std::string BusControllerCan::GetDeviceID() const
{
  return mDeviceID.get();
}

void BusControllerCan::SetDeviceID(std::string newValue)
{
  mDeviceID.set(newValue);
  mDirty |= kDeviceIDBit;
}

// attribute BaudRate : HLAinteger32LE
int32_t BusControllerCan::GetBaudRate() const
{
  return mBaudRate.get();
}

void BusControllerCan::SetBaudRate(int32_t newValue)
{
  mBaudRate.set(newValue);
  mDirty |= kBaudRateBit;
}

// attribute DataBaudRate : HLAinteger32LE
int32_t BusControllerCan::GetDataBaudRate() const
{
  return mDataBaudRate.get();
}

void BusControllerCan::SetDataBaudRate(int32_t newValue)
{
  mDataBaudRate.set(newValue);
  mDirty |= kDataBaudRateBit;
}

// attribute PreScaler : HLAinteger32LE
int32_t BusControllerCan::GetPreScaler() const
{
  return mPreScaler.get();
}

void BusControllerCan::SetPreScaler(int32_t newValue)
{
  mPreScaler.set(newValue);
  mDirty |= kPreScalerBit;
}

// attribute OperationMode : CanOperationMode
CanOperationMode BusControllerCan::GetOperationMode() const
{
  return static_cast<CanOperationMode>(mOperationMode.get());
}

void BusControllerCan::SetOperationMode(CanOperationMode newValue)
{
  mOperationMode.set(newValue);
  mDirty |= kOperationModeBit;
}

// attribute Sync_Seg : HLAinteger32LE
int32_t BusControllerCan::GetSync_Seg() const
{
  return mSync_Seg.get();
}

void BusControllerCan::SetSync_Seg(int32_t newValue)
{
  mSync_Seg.set(newValue);
  mDirty |= kSync_SegBit;
}

// attribute Prop_Seg : HLAinteger32LE
int32_t BusControllerCan::GetProp_Seg() const
{
  return mProp_Seg.get();
}

void BusControllerCan::SetProp_Seg(int32_t newValue)
{
  mProp_Seg.set(newValue);
  mDirty |= kProp_SegBit;
}

// attribute Phase_Seg1 : HLAinteger32LE
int32_t BusControllerCan::GetPhase_Seg1() const
{
  return mPhase_Seg1.get();
}

void BusControllerCan::SetPhase_Seg1(int32_t newValue)
{
  mPhase_Seg1.set(newValue);
  mDirty |= kPhase_Seg1Bit;
}

// attribute Phase_Seg2 : HLAinteger32LE
int32_t BusControllerCan::GetPhase_Seg2() const
{
  return mPhase_Seg2.get();
}

void BusControllerCan::SetPhase_Seg2(int32_t newValue)
{
  mPhase_Seg2.set(newValue);
  mDirty |= kPhase_Seg2Bit;
}

// attribute SamplingMode : CanSamplingMode
CanSamplingMode BusControllerCan::GetSamplingMode() const
{
  return static_cast<CanSamplingMode>(mSamplingMode.get());
}

void BusControllerCan::SetSamplingMode(CanSamplingMode newValue)
{
  mSamplingMode.set(newValue);
  mDirty |= kSamplingModeBit;
}

rti1516ev::AttributeHandleValueMap BusControllerCan::GetAllAttributeValues() const
{
  rti1516ev::AttributeHandleValueMap result;
  result[mObjectClass->GetNetworkIDAttributeHandle()] = mNetworkID.encode();
  result[mObjectClass->GetDeviceIDAttributeHandle()] = mDeviceID.encode();
  result[mObjectClass->GetBaudRateAttributeHandle()] = mBaudRate.encode();
  result[mObjectClass->GetDataBaudRateAttributeHandle()] = mDataBaudRate.encode();
  result[mObjectClass->GetPreScalerAttributeHandle()] = mPreScaler.encode();
  result[mObjectClass->GetOperationModeAttributeHandle()] = mOperationMode.encode();
  result[mObjectClass->GetSync_SegAttributeHandle()] = mSync_Seg.encode();
  result[mObjectClass->GetProp_SegAttributeHandle()] = mProp_Seg.encode();
  result[mObjectClass->GetPhase_Seg1AttributeHandle()] = mPhase_Seg1.encode();
  result[mObjectClass->GetPhase_Seg2AttributeHandle()] = mPhase_Seg2.encode();
  result[mObjectClass->GetSamplingModeAttributeHandle()] = mSamplingMode.encode();
  return result;
}

rti1516ev::AttributeHandleValueMap BusControllerCan::GetModifiedAttributeValues() const
{
  rti1516ev::AttributeHandleValueMap result;
  if (mDirty & kBaudRateBit)
  {
    result[mObjectClass->GetBaudRateAttributeHandle()] = mBaudRate.encode();
  }
  if (mDirty & kDataBaudRateBit)
  {
    result[mObjectClass->GetDataBaudRateAttributeHandle()] = mDataBaudRate.encode();
  }
  if (mDirty & kPreScalerBit)
  {
    result[mObjectClass->GetPreScalerAttributeHandle()] = mPreScaler.encode();
  }
  if (mDirty & kOperationModeBit)
  {
    result[mObjectClass->GetOperationModeAttributeHandle()] = mOperationMode.encode();
  }
  if (mDirty & kSync_SegBit)
  {
    result[mObjectClass->GetSync_SegAttributeHandle()] = mSync_Seg.encode();
  }
  if (mDirty & kProp_SegBit)
  {
    result[mObjectClass->GetProp_SegAttributeHandle()] = mProp_Seg.encode();
  }
  if (mDirty & kPhase_Seg1Bit)
  {
    result[mObjectClass->GetPhase_Seg1AttributeHandle()] = mPhase_Seg1.encode();
  }
  if (mDirty & kPhase_Seg2Bit)
  {
    result[mObjectClass->GetPhase_Seg2AttributeHandle()] = mPhase_Seg2.encode();
  }
  if (mDirty & kSamplingModeBit)
  {
    result[mObjectClass->GetSamplingModeAttributeHandle()] = mSamplingMode.encode();
  }
  return result;
}

void BusControllerCan::UpdateAllAttributeValues()
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetAllAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData());
  }
}

void BusControllerCan::UpdateAllAttributeValues(const rti1516ev::LogicalTime& time)
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetAllAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData(), time);
  }
}

void BusControllerCan::UpdateModifiedAttributeValues()
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetModifiedAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData());
    mDirty = kNone;
  }
}

void BusControllerCan::UpdateModifiedAttributeValues(const rti1516ev::LogicalTime& time)
{
  if (IsValid())
  {
    rti1516ev::AttributeHandleValueMap attributes = GetModifiedAttributeValues();
    mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, attributes, rti1516ev::VariableLengthData(), time);
    mDirty = kNone;
  }
}

void BusControllerCan::ReflectAttributeValues(const rti1516ev::AttributeHandleValueMap& attributes)
{
  for (auto& attributeHandleValue : attributes)
  {
    rti1516ev::AttributeHandle attributeHandle = attributeHandleValue.first;
    if (attributeHandle == mObjectClass->GetBaudRateAttributeHandle())
    {
      mBaudRate.decode(attributeHandleValue.second);
      mLastUpdated |= kBaudRateBit;
    }
    else if (attributeHandle == mObjectClass->GetDataBaudRateAttributeHandle())
    {
      mDataBaudRate.decode(attributeHandleValue.second);
      mLastUpdated |= kDataBaudRateBit;
    }
    else if (attributeHandle == mObjectClass->GetPreScalerAttributeHandle())
    {
      mPreScaler.decode(attributeHandleValue.second);
      mLastUpdated |= kPreScalerBit;
    }
    else if (attributeHandle == mObjectClass->GetOperationModeAttributeHandle())
    {
      mOperationMode.decode(attributeHandleValue.second);
      mLastUpdated |= kOperationModeBit;
    }
    else if (attributeHandle == mObjectClass->GetSync_SegAttributeHandle())
    {
      mSync_Seg.decode(attributeHandleValue.second);
      mLastUpdated |= kSync_SegBit;
    }
    else if (attributeHandle == mObjectClass->GetProp_SegAttributeHandle())
    {
      mProp_Seg.decode(attributeHandleValue.second);
      mLastUpdated |= kProp_SegBit;
    }
    else if (attributeHandle == mObjectClass->GetPhase_Seg1AttributeHandle())
    {
      mPhase_Seg1.decode(attributeHandleValue.second);
      mLastUpdated |= kPhase_Seg1Bit;
    }
    else if (attributeHandle == mObjectClass->GetPhase_Seg2AttributeHandle())
    {
      mPhase_Seg2.decode(attributeHandleValue.second);
      mLastUpdated |= kPhase_Seg2Bit;
    }
    else if (attributeHandle == mObjectClass->GetSamplingModeAttributeHandle())
    {
      mSamplingMode.decode(attributeHandleValue.second);
      mLastUpdated |= kSamplingModeBit;
    }
  } // for (auto& attributeHandleValue : attributes)
    ExecuteUpdateCallbacks();
} // BusControllerCan::ReflectAttributeValues

void BusControllerCan::ProvideAttributeValues(const rti1516ev::AttributeHandleSet& attributeHandles)
{
  rti1516ev::AttributeHandleValueMap updateAttributes;
  for (auto& attributeHandle : attributeHandles)
  {
    if (attributeHandle == mObjectClass->GetBaudRateAttributeHandle())
    {
      updateAttributes.insert(std::make_pair(attributeHandle, mBaudRate.encode()));
      mDirty &= ~kBaudRateBit;
    }
    else if (attributeHandle == mObjectClass->GetDataBaudRateAttributeHandle())
    {
      updateAttributes.insert(std::make_pair(attributeHandle, mDataBaudRate.encode()));
      mDirty &= ~kDataBaudRateBit;
    }
    else if (attributeHandle == mObjectClass->GetPreScalerAttributeHandle())
    {
      updateAttributes.insert(std::make_pair(attributeHandle, mPreScaler.encode()));
      mDirty &= ~kPreScalerBit;
    }
    else if (attributeHandle == mObjectClass->GetOperationModeAttributeHandle())
    {
      updateAttributes.insert(std::make_pair(attributeHandle, mOperationMode.encode()));
      mDirty &= ~kOperationModeBit;
    }
    else if (attributeHandle == mObjectClass->GetSync_SegAttributeHandle())
    {
      updateAttributes.insert(std::make_pair(attributeHandle, mSync_Seg.encode()));
      mDirty &= ~kSync_SegBit;
    }
    else if (attributeHandle == mObjectClass->GetProp_SegAttributeHandle())
    {
      updateAttributes.insert(std::make_pair(attributeHandle, mProp_Seg.encode()));
      mDirty &= ~kProp_SegBit;
    }
    else if (attributeHandle == mObjectClass->GetPhase_Seg1AttributeHandle())
    {
      updateAttributes.insert(std::make_pair(attributeHandle, mPhase_Seg1.encode()));
      mDirty &= ~kPhase_Seg1Bit;
    }
    else if (attributeHandle == mObjectClass->GetPhase_Seg2AttributeHandle())
    {
      updateAttributes.insert(std::make_pair(attributeHandle, mPhase_Seg2.encode()));
      mDirty &= ~kPhase_Seg2Bit;
    }
    else if (attributeHandle == mObjectClass->GetSamplingModeAttributeHandle())
    {
      updateAttributes.insert(std::make_pair(attributeHandle, mSamplingMode.encode()));
      mDirty &= ~kSamplingModeBit;
    }
  } // for (auto& attributeHandleValue : attributes)
  mRtiAmbassador->updateAttributeValues(mObjectInstanceHandle, updateAttributes, rti1516ev::VariableLengthData());
} // BusControllerCan::ReflectAttributeValues

uint32_t BusControllerCan::RegisterUpdateCallback(UpdateCallbackType callback)
{
  mLastCallbackToken++;
  mUpdateCallbacks.insert(std::make_pair(mLastCallbackToken, callback));
  return mLastCallbackToken;
}

void BusControllerCan::UnregisterUpdateCallback(uint32_t callbackToken)
{
  mUpdateCallbacks.erase(callbackToken);
}

void BusControllerCan::ExecuteUpdateCallbacks()
{
  for (auto& callbackEntry : mUpdateCallbacks)
  {
    auto& callback = callbackEntry.second;
    callback(this);
  }
}

 

ObjectClassRegistry* ObjectClassRegistry::sClassRegistry = nullptr;

ObjectClassRegistry::ObjectClassRegistry()
{
  assert(sClassRegistry == nullptr);
  sClassRegistry = this;
}

ObjectClassRegistry::~ObjectClassRegistry()
{
  sClassRegistry = nullptr;
}

void ObjectClassRegistry::Initialize(rti1516ev::RTIambassador* rtiAmbassador)
{
  mRtiAmbassador = rtiAmbassador;
  mHLAobjectRootObjectClass = std::unique_ptr<HLAobjectRootObjectClass>(new HLAobjectRootObjectClass(mRtiAmbassador));
  mSystemVariableObjectClass = std::unique_ptr<SystemVariableObjectClass>(new SystemVariableObjectClass(mRtiAmbassador, mHLAobjectRootObjectClass.get()));
  mValueEntityObjectClass = std::unique_ptr<ValueEntityObjectClass>(new ValueEntityObjectClass(mRtiAmbassador, mHLAobjectRootObjectClass.get()));
  mDOMemberSourceObjectClass = std::unique_ptr<DOMemberSourceObjectClass>(new DOMemberSourceObjectClass(mRtiAmbassador, mHLAobjectRootObjectClass.get()));
  mDOMemberTargetObjectClass = std::unique_ptr<DOMemberTargetObjectClass>(new DOMemberTargetObjectClass(mRtiAmbassador, mHLAobjectRootObjectClass.get()));
  mBusManagementObjectClass = std::unique_ptr<BusManagementObjectClass>(new BusManagementObjectClass(mRtiAmbassador, mHLAobjectRootObjectClass.get()));
  mBusManagementCanObjectClass = std::unique_ptr<BusManagementCanObjectClass>(new BusManagementCanObjectClass(mRtiAmbassador, mBusManagementObjectClass.get()));
  mBusControllerObjectClass = std::unique_ptr<BusControllerObjectClass>(new BusControllerObjectClass(mRtiAmbassador, mHLAobjectRootObjectClass.get()));
  mBusControllerCanObjectClass = std::unique_ptr<BusControllerCanObjectClass>(new BusControllerCanObjectClass(mRtiAmbassador, mBusControllerObjectClass.get()));
} // Initialize

void ObjectClassRegistry::DiscoverObjectInstance(rti1516ev::ObjectInstanceHandle theObject, std::wstring const & theObjectInstanceName)
{
  rti1516ev::ObjectClassHandle theObjectClass = mRtiAmbassador->getKnownObjectClassHandle(theObject);
  if (theObjectClass == mHLAobjectRootObjectClass->GetObjectClassHandle())
  {
    mHLAobjectRootObjectClass->DiscoverObjectInstance(theObject, theObjectInstanceName);
  }
  else if (theObjectClass == mSystemVariableObjectClass->GetObjectClassHandle())
  {
    mSystemVariableObjectClass->DiscoverObjectInstance(theObject, theObjectInstanceName);
  }
  else if (theObjectClass == mValueEntityObjectClass->GetObjectClassHandle())
  {
    mValueEntityObjectClass->DiscoverObjectInstance(theObject, theObjectInstanceName);
  }
  else if (theObjectClass == mDOMemberSourceObjectClass->GetObjectClassHandle())
  {
    mDOMemberSourceObjectClass->DiscoverObjectInstance(theObject, theObjectInstanceName);
  }
  else if (theObjectClass == mDOMemberTargetObjectClass->GetObjectClassHandle())
  {
    mDOMemberTargetObjectClass->DiscoverObjectInstance(theObject, theObjectInstanceName);
  }
  else if (theObjectClass == mBusManagementObjectClass->GetObjectClassHandle())
  {
    mBusManagementObjectClass->DiscoverObjectInstance(theObject, theObjectInstanceName);
  }
  else if (theObjectClass == mBusManagementCanObjectClass->GetObjectClassHandle())
  {
    mBusManagementCanObjectClass->DiscoverObjectInstance(theObject, theObjectInstanceName);
  }
  else if (theObjectClass == mBusControllerObjectClass->GetObjectClassHandle())
  {
    mBusControllerObjectClass->DiscoverObjectInstance(theObject, theObjectInstanceName);
  }
  else if (theObjectClass == mBusControllerCanObjectClass->GetObjectClassHandle())
  {
    mBusControllerCanObjectClass->DiscoverObjectInstance(theObject, theObjectInstanceName);
  }
}

void ObjectClassRegistry::RemoveObjectInstance(rti1516ev::ObjectInstanceHandle theObject)
{
  rti1516ev::ObjectClassHandle theObjectClass = mRtiAmbassador->getKnownObjectClassHandle(theObject);
  if (theObjectClass == mHLAobjectRootObjectClass->GetObjectClassHandle())
  {
    mHLAobjectRootObjectClass->RemoveObjectInstance(theObject);
  }
  else if (theObjectClass == mSystemVariableObjectClass->GetObjectClassHandle())
  {
    mSystemVariableObjectClass->RemoveObjectInstance(theObject);
  }
  else if (theObjectClass == mValueEntityObjectClass->GetObjectClassHandle())
  {
    mValueEntityObjectClass->RemoveObjectInstance(theObject);
  }
  else if (theObjectClass == mDOMemberSourceObjectClass->GetObjectClassHandle())
  {
    mDOMemberSourceObjectClass->RemoveObjectInstance(theObject);
  }
  else if (theObjectClass == mDOMemberTargetObjectClass->GetObjectClassHandle())
  {
    mDOMemberTargetObjectClass->RemoveObjectInstance(theObject);
  }
  else if (theObjectClass == mBusManagementObjectClass->GetObjectClassHandle())
  {
    mBusManagementObjectClass->RemoveObjectInstance(theObject);
  }
  else if (theObjectClass == mBusManagementCanObjectClass->GetObjectClassHandle())
  {
    mBusManagementCanObjectClass->RemoveObjectInstance(theObject);
  }
  else if (theObjectClass == mBusControllerObjectClass->GetObjectClassHandle())
  {
    mBusControllerObjectClass->RemoveObjectInstance(theObject);
  }
  else if (theObjectClass == mBusControllerCanObjectClass->GetObjectClassHandle())
  {
    mBusControllerCanObjectClass->RemoveObjectInstance(theObject);
  }
}

void ObjectClassRegistry::ReflectAttributeValues(rti1516ev::ObjectInstanceHandle theObject, const rti1516ev::AttributeHandleValueMap & attributes)
{
  rti1516ev::ObjectClassHandle theObjectClass = mRtiAmbassador->getKnownObjectClassHandle(theObject);
  if (theObjectClass == mSystemVariableObjectClass->GetObjectClassHandle())
  {
    static_cast<SystemVariable*>(mSystemVariableObjectClass->GetObjectInstance(theObject))->ReflectAttributeValues(attributes);
  }
  else if (theObjectClass == mValueEntityObjectClass->GetObjectClassHandle())
  {
    static_cast<ValueEntity*>(mValueEntityObjectClass->GetObjectInstance(theObject))->ReflectAttributeValues(attributes);
  }
  else if (theObjectClass == mDOMemberSourceObjectClass->GetObjectClassHandle())
  {
    static_cast<DOMemberSource*>(mDOMemberSourceObjectClass->GetObjectInstance(theObject))->ReflectAttributeValues(attributes);
  }
  else if (theObjectClass == mDOMemberTargetObjectClass->GetObjectClassHandle())
  {
    static_cast<DOMemberTarget*>(mDOMemberTargetObjectClass->GetObjectInstance(theObject))->ReflectAttributeValues(attributes);
  }
  else if (theObjectClass == mBusManagementObjectClass->GetObjectClassHandle())
  {
    static_cast<BusManagement*>(mBusManagementObjectClass->GetObjectInstance(theObject))->ReflectAttributeValues(attributes);
  }
  else if (theObjectClass == mBusManagementCanObjectClass->GetObjectClassHandle())
  {
    static_cast<BusManagementCan*>(mBusManagementCanObjectClass->GetObjectInstance(theObject))->ReflectAttributeValues(attributes);
  }
  else if (theObjectClass == mBusControllerObjectClass->GetObjectClassHandle())
  {
    static_cast<BusController*>(mBusControllerObjectClass->GetObjectInstance(theObject))->ReflectAttributeValues(attributes);
  }
  else if (theObjectClass == mBusControllerCanObjectClass->GetObjectClassHandle())
  {
    static_cast<BusControllerCan*>(mBusControllerCanObjectClass->GetObjectInstance(theObject))->ReflectAttributeValues(attributes);
  }
}

void ObjectClassRegistry::ProvideAttributeValues(rti1516ev::ObjectClassHandle theObjectClass, rti1516ev::ObjectInstanceHandle theObject, const rti1516ev::AttributeHandleSet& attributeHandles)
{
  if (theObjectClass == mSystemVariableObjectClass->GetObjectClassHandle())
  {
    static_cast<SystemVariable*>(mSystemVariableObjectClass->GetObjectInstance(theObject))->ProvideAttributeValues(attributeHandles);
  }
  else if (theObjectClass == mValueEntityObjectClass->GetObjectClassHandle())
  {
    static_cast<ValueEntity*>(mValueEntityObjectClass->GetObjectInstance(theObject))->ProvideAttributeValues(attributeHandles);
  }
  else if (theObjectClass == mDOMemberSourceObjectClass->GetObjectClassHandle())
  {
    static_cast<DOMemberSource*>(mDOMemberSourceObjectClass->GetObjectInstance(theObject))->ProvideAttributeValues(attributeHandles);
  }
  else if (theObjectClass == mDOMemberTargetObjectClass->GetObjectClassHandle())
  {
    static_cast<DOMemberTarget*>(mDOMemberTargetObjectClass->GetObjectInstance(theObject))->ProvideAttributeValues(attributeHandles);
  }
  else if (theObjectClass == mBusManagementObjectClass->GetObjectClassHandle())
  {
    static_cast<BusManagement*>(mBusManagementObjectClass->GetObjectInstance(theObject))->ProvideAttributeValues(attributeHandles);
  }
  else if (theObjectClass == mBusManagementCanObjectClass->GetObjectClassHandle())
  {
    static_cast<BusManagementCan*>(mBusManagementCanObjectClass->GetObjectInstance(theObject))->ProvideAttributeValues(attributeHandles);
  }
  else if (theObjectClass == mBusControllerObjectClass->GetObjectClassHandle())
  {
    static_cast<BusController*>(mBusControllerObjectClass->GetObjectInstance(theObject))->ProvideAttributeValues(attributeHandles);
  }
  else if (theObjectClass == mBusControllerCanObjectClass->GetObjectClassHandle())
  {
    static_cast<BusControllerCan*>(mBusControllerCanObjectClass->GetObjectInstance(theObject))->ProvideAttributeValues(attributeHandles);
  }
}

void ObjectClassRegistry::RegisterObjectInstanceName(const std::wstring& theObjectInstanceName, std::function<void(bool)> completionCallback)
{
  mInstanceNameReservationCallbacks.insert(std::make_pair(theObjectInstanceName, completionCallback));
  mRtiAmbassador->reserveObjectInstanceName(theObjectInstanceName);
}

void ObjectClassRegistry::ObjectInstanceNameReservationSucceeded(const std::wstring& theObjectInstanceName)
{
  auto iter = mInstanceNameReservationCallbacks.find(theObjectInstanceName);
  iter->second(true);
  mInstanceNameReservationCallbacks.erase(iter);
}

void ObjectClassRegistry::ObjectInstanceNameReservationFailed(const std::wstring& theObjectInstanceName)
{
  auto iter = mInstanceNameReservationCallbacks.find(theObjectInstanceName);
  iter->second(false);
  mInstanceNameReservationCallbacks.erase(iter);
}

IObjectClassRegistry* GetClassRegistry()
{
  return ObjectClassRegistry::GetInstance();
}

} // namespace NDistSimIB
} // namespace NRTFederateEncoding
